{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\excel-table\\modules\\final-forecast-fill\\Update.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\excel-table\\modules\\final-forecast-fill\\Update.vue","mtime":1674799497248},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667355379758},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1667355356562}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgaTE4biBmcm9tICIuLi8uLi8uLi8uLi9pMThuIjsNCg0KY29uc3QgTUFJTl9BUElfVVJMID0gJ3N0YXRpc3RpYy1yZXBvcnQnDQoNCmltcG9ydCBJbmZvIGZyb20gIi4vSW5mbyI7DQppbXBvcnQgYXBwQ29uZmlnIGZyb20gIkAvYXBwLmNvbmZpZyI7DQppbXBvcnQgYXBpU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9hcGkuc2VydmljZSI7DQppbXBvcnQgWExTWCBmcm9tICJ4bHN4IjsNCg0KY29uc3QgdXJscyA9IHsNCiAgY3JlYXRlOiBNQUlOX0FQSV9VUkwgKyAnL2NyZWF0ZScsDQogIHVwZGF0ZTogTUFJTl9BUElfVVJMICsgJy91cGRhdGUvJywNCiAgc2F2ZVZhbHVlOiBNQUlOX0FQSV9VUkwgKyAnL3NhdmUtdmFsdWUnLA0KICBnZXQ6IE1BSU5fQVBJX1VSTCArICcvZ2V0LWJ5LWlkLycsDQogIHF1YXJ0ZXI6IE1BSU5fQVBJX1VSTCArICcvZGlyZWN0b3J5L3F1YXJ0ZXIvbGlzdC1zZWFyY2gnLA0KICBtZWFzdXJlbWVudFVuaXQ6IE1BSU5fQVBJX1VSTCArICcvZGlyZWN0b3J5L21lYXN1cmVtZW50LXVuaXQvbGlzdC1zZWFyY2gnLA0KICBpbm5lckVtcGxveWVlOiAnL2VtcGxveWVlL2xpc3Qtc2VhcmNoL2lubmVyJywNCiAgY29uZmlybVF1YXJ0ZXJWYWx1ZTogJy9zdGF0aXN0aWMtcmVwb3J0L2NvbmZpcm0tcXVhcnRlci12YWx1ZS8nLA0KfQ0KDQpleHBvcnQgZGVmYXVsdCB7DQogIHBhZ2U6IHsNCiAgICB0aXRsZTogaTE4bi50KCdzdWJtb2R1bGVzLmZpbmFsX2ZvcmVjYXN0LnRpdGxlJyksDQogICAgbWV0YTogW3tuYW1lOiAiZGVzY3JpcHRpb24iLCBjb250ZW50OiBhcHBDb25maWcuZGVzY3JpcHRpb259XSwNCiAgfSwNCiAgY29tcG9uZW50czogew0KICAgIEluZm8sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGZvcm06IHt9LA0KICAgICAgbW9kYWw6IHsNCiAgICAgICAgc2hvdzogZmFsc2UsDQogICAgICAgIHN0ZXA6ICcnLA0KICAgICAgICB0aXRsZTogIiIsDQogICAgICAgIGluZm9UeXBlS2V5OiAnJywNCiAgICAgICAgcGFyZW50SW5kZXg6IDAsDQogICAgICAgIGNoaWxkSW5kZXg6IHVuZGVmaW5lZCwNCiAgICAgICAgcXVhcnRlcktleTogdW5kZWZpbmVkLA0KICAgICAgICBiYXNlczogdW5kZWZpbmVkLA0KICAgICAgfSwNCiAgICAgIGluZm9UeXBlTGlzdDogWw0KICAgICAgICB7DQogICAgICAgICAgY29kZTogJ0ZJTkFMJywNCiAgICAgICAgICBuYW1lOiBpMThuLnQoJ3N1Ym1vZHVsZXMuZmluYWxfZm9yZWNhc3QuaW5mb190eXBlX2ZpbmFsJyksDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBjb2RlOiAnRElSRUNUTFknLA0KICAgICAgICAgIG5hbWU6IGkxOG4udCgnc3VibW9kdWxlcy5maW5hbF9mb3JlY2FzdC5pbmZvX3R5cGVfZGlyZWN0bHknKSwNCiAgICAgICAgfSwNCiAgICAgIF0sDQogICAgICBxdWFydGVyTGlzdDogW10sDQogICAgICBtZWFzdXJlbWVudFVuaXRMaXN0OiBbXSwNCiAgICAgIG1lYXN1cmVtZW50VW5pdE1hcDoge30sDQogICAgICBlbXBsb3llZUxpc3RLZXl3b3JkOiAnJywNCiAgICAgIGVtcGxveWVlTGlzdDogW10sDQogICAgICBlbXBsb3llZUxpc3RNYXA6IHt9LA0KICAgICAgc2F2ZUxvYWRpbmc6IGZhbHNlLA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRFbXBsb3llZUlubmVyTGlzdCgpIHsNCiAgICAgIGFwaVNlcnZpY2UucG9zdCh1cmxzLmlubmVyRW1wbG95ZWUgKyAnP2tleXdvcmQ9JyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmVtcGxveWVlTGlzdEtleXdvcmQpLCB7DQogICAgICAgIGl0ZW1zUGVyUGFnZTogMTAsDQogICAgICAgIHBhZ2U6IDAsDQogICAgICB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuZW1wbG95ZWVMaXN0ID0gcmVzLmRhdGEubGlzdDsNCiAgICAgICAgdGhpcy5lbXBsb3llZUxpc3RNYXAgPSB7fTsNCiAgICAgICAgdGhpcy5lbXBsb3llZUxpc3QuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICB0aGlzLmVtcGxveWVlTGlzdE1hcFtpdGVtLmlkXSA9IGl0ZW07DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBvcGVuTW9kYWwoc2hvdywgc3RlcCwgaW5mb1R5cGVLZXksIHBhcmVudEluZGV4LCBjaGlsZEluZGV4LCBxdWFydGVyS2V5ID0gdW5kZWZpbmVkKSB7DQogICAgICBjb25zb2xlLmxvZyhzaG93LCBzdGVwLCBpbmZvVHlwZUtleSwgcGFyZW50SW5kZXgsIGNoaWxkSW5kZXgsIHF1YXJ0ZXJLZXkpDQogICAgICB0aGlzLm1vZGFsLnNob3cgPSBzaG93Ow0KICAgICAgdGhpcy5tb2RhbC5zdGVwID0gc3RlcDsNCiAgICAgIHRoaXMubW9kYWwuaW5mb1R5cGVLZXkgPSBpbmZvVHlwZUtleTsNCiAgICAgIHRoaXMubW9kYWwucGFyZW50SW5kZXggPSBwYXJlbnRJbmRleDsNCiAgICAgIHRoaXMubW9kYWwuY2hpbGRJbmRleCA9IGNoaWxkSW5kZXg7DQogICAgICB0aGlzLm1vZGFsLnF1YXJ0ZXJLZXkgPSBxdWFydGVyS2V5Ow0KICAgIH0sDQogICAgY3VzdG9tTGFiZWxBZERlc2lnblR5cGUoaWQpIHsNCiAgICAgIGxldCBzZWxlY3RlZCA9IHRoaXMuZW1wbG95ZWVMaXN0TWFwW2lkXTsNCiAgICAgIGlmIChzZWxlY3RlZCkgew0KICAgICAgICByZXR1cm4gc2VsZWN0ZWQuZnVsbE5hbWU7DQogICAgICB9DQogICAgICByZXR1cm4gJyc7DQogICAgfSwNCiAgICBjdXN0b21MYWJlbE1lYXN1cmVtZW50VW5pdExpc3QoaWQpIHsNCiAgICAgIGxldCBzZWxlY3RlZCA9IHRoaXMubWVhc3VyZW1lbnRVbml0TGlzdFtpZF07DQogICAgICBpZiAoc2VsZWN0ZWQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZSh7fSk7DQogICAgICB9DQogICAgICByZXR1cm4gJyc7DQogICAgfSwNCiAgICBvbkVtcGxveWVlQ2hhbmdlKHNlbGVjdGVkTGlzdCkgew0KICAgICAgaWYgKHRoaXMubW9kYWwuc3RlcCA9PT0gJ2VtcGxveWVlX2NoaWxkJykgew0KICAgICAgICB0aGlzLmZvcm0uU3RhdGlzdGljUmVwb3J0SW5mb0R0b1t0aGlzLm1vZGFsLnBhcmVudEluZGV4XS5jaGlsZHJlblt0aGlzLm1vZGFsLmNoaWxkSW5kZXhdLmVtcGxveWVlRnVsbE5hbWVzID0gc2VsZWN0ZWRMaXN0Lm1hcChlID0+IHsNCiAgICAgICAgICByZXR1cm4gdGhpcy5lbXBsb3llZUxpc3RNYXBbZV0ubGFzdE5hbWUgKyAnICcgKyB0aGlzLmVtcGxveWVlTmFtZUZpcnN0Q2hhcih0aGlzLmVtcGxveWVlTGlzdE1hcFtlXS5maXJzdE5hbWUpICsgJyAnICsgdGhpcy5lbXBsb3llZU5hbWVGaXJzdENoYXIodGhpcy5lbXBsb3llZUxpc3RNYXBbZV0ubWlkZGxlTmFtZSk7DQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGFsLnN0ZXAgPT09ICdlbXBsb3llZScpIHsNCiAgICAgICAgdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uZW1wbG95ZWVGdWxsTmFtZXMgPSBzZWxlY3RlZExpc3QubWFwKGUgPT4gew0KICAgICAgICAgIHJldHVybiB0aGlzLmVtcGxveWVlTGlzdE1hcFtlXS5sYXN0TmFtZSArICcgJyArIHRoaXMuZW1wbG95ZWVOYW1lRmlyc3RDaGFyKHRoaXMuZW1wbG95ZWVMaXN0TWFwW2VdLmZpcnN0TmFtZSkgKyAnICcgKyB0aGlzLmVtcGxveWVlTmFtZUZpcnN0Q2hhcih0aGlzLmVtcGxveWVlTGlzdE1hcFtlXS5taWRkbGVOYW1lKTsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICB0aGlzLiRyZWZzWydpbmZvVHlwZSddW3RoaXMubW9kYWwuaW5mb1R5cGVLZXldLnNlcmlhbGl6ZUl0ZW1zKCkNCiAgICB9LA0KICAgIGVtcGxveWVlTmFtZUZpcnN0Q2hhcihuYW1lKSB7DQogICAgICBsZXQgZnMgPSBuYW1lLmNoYXJBdCgwKSArIG5hbWUuY2hhckF0KDEpOw0KICAgICAgaWYgKFsnc2gnLCAnY2gnLCAibyciLCAiZyciXS5pbmRleE9mKGZzLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgnYCcsICInIikpICE9PSAtMSkgew0KICAgICAgICByZXR1cm4gZnM7DQogICAgICB9DQogICAgICByZXR1cm4gbmFtZS5jaGFyQXQoMCk7DQogICAgfSwNCiAgICBzYXZlKCkgew0KICAgICAgaWYgKHRoaXMuc2F2ZUxvYWRpbmcpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IHRydWU7DQogICAgICBsZXQgZGF0YSA9IHRoaXMuc2VyaWFsaXplU2F2ZVJlc3VsdCh0aGlzLmZvcm0uU3RhdGlzdGljUmVwb3J0SW5mb0R0byk7DQogICAgICBhcGlTZXJ2aWNlLnBvc3QodXJscy5zYXZlVmFsdWUsIGRhdGEsIHRydWUpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy4kdG9hc3QodGhpcy4kdCgnbWVzc2FnZXMuc2F2ZWRfc3VjY2Vzc2Z1bGx5JyksIHsNCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMuc2F2ZUxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdJbmRleEZpbmFsRm9yZWNhc3RGaWxsJ30pOw0KICAgICAgfSkuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IGZhbHNlOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBzZXJpYWxpemVTYXZlUmVzdWx0KGluZm9zLCByZXN1bHQgPSBbXSkgew0KICAgICAgZm9yIChjb25zdCBpbmRleCBpbiBpbmZvcykgew0KICAgICAgICBpbmZvc1tpbmRleF0ucXVhcnRlclZhbHVlRHRvTGlzdC5tYXAoZSA9PiB7DQogICAgICAgICAgcmVzdWx0LnB1c2goew0KICAgICAgICAgICAgaWQ6IGUuaWQsDQogICAgICAgICAgICBkb25lOiBlLmRvbmUsDQogICAgICAgICAgICBxdWFydGVySWQ6IGUucXVhcnRlcklkLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgICAgaWYgKGluZm9zW2luZGV4XS5jaGlsZHJlbikgew0KICAgICAgICAgIHJlc3VsdCA9IHRoaXMuc2VyaWFsaXplU2F2ZVJlc3VsdChpbmZvc1tpbmRleF0uY2hpbGRyZW4sIHJlc3VsdCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiByZXN1bHQ7DQogICAgfSwNCiAgICBzZXJpYWxpemVFbXBsb3llZUlkcyhpbmZvTGlzdCkgew0KICAgICAgcmV0dXJuIGluZm9MaXN0Lm1hcChpbmZvID0+IHsNCiAgICAgICAgaW5mby5lbXBsb3llZUlkcyA9IGluZm8uYXR0YWNoZWRFbXBsb3llZUR0b3MubWFwKGUgPT4gew0KICAgICAgICAgIHJldHVybiBlLmVtcGxveWVlSWQ7DQogICAgICAgIH0pOw0KICAgICAgICBpbmZvLmVtcGxveWVlRnVsbE5hbWVzID0gaW5mby5hdHRhY2hlZEVtcGxveWVlRHRvcy5tYXAoZSA9PiB7DQogICAgICAgICAgcmV0dXJuIGUuZW1wbG95ZWVMYXN0TmFtZSArICcgJyArIGUuZW1wbG95ZWVGaXJzdE5hbWUgKyAnICcgKyBlLmVtcGxveWVlTWlkZGxlTmFtZTsNCiAgICAgICAgfSk7DQogICAgICAgIGlmIChpbmZvLmNoaWxkcmVuKSB7DQogICAgICAgICAgaW5mby5jaGlsZHJlbiA9IHRoaXMuc2VyaWFsaXplRW1wbG95ZWVJZHMoaW5mby5jaGlsZHJlbik7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGluZm87DQogICAgICB9KTsNCiAgICB9LA0KICAgIGV4Y2VsRXhwb3J0KCkgew0KICAgICAgdGhpcy5sb2FkZXJFeGNlbCA9IHRydWU7DQogICAgICBsZXQgZmlsZU5hbWUgPSBgUmVwb3J0YDsNCiAgICAgIGxldCB3YiA9IFhMU1gudXRpbHMudGFibGVfdG9fYm9vayh0aGlzLiRyZWZzLnRhYmxlLCB7c2hlZXQ6ICJzaGVldDEifSk7DQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgdGhpcy5sb2FkZXJFeGNlbCA9IGZhbHNlOw0KICAgICAgfSwgNTAwKTsNCiAgICAgIHJldHVybiBYTFNYLndyaXRlRmlsZSh3YiwgYCR7ZmlsZU5hbWV9Lnhsc3hgLCB7fSk7DQogICAgfSwNCiAgICBjb25maXJtUXVhcnRlclZhbHVlKHtpZH0pIHsNCiAgICAgIHRoaXMuY25mKCkudGhlbigoe3ZhbHVlfSkgPT4gew0KICAgICAgICBpZiAodmFsdWUpIHsNCiAgICAgICAgICBhcGlTZXJ2aWNlLnBvc3QodXJscy5jb25maXJtUXVhcnRlclZhbHVlICsgaWQsIHt9LCB0cnVlKS50aGVuKGFzeW5jIHJlcyA9PiB7DQogICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUNyZWF0ZWQoKQ0KICAgICAgICAgICAgYXdhaXQgdGhpcy4kdG9hc3QodGhpcy4kdCgnc3VjY2VzcycpLCB7DQogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGhhbmRsZUNyZWF0ZWQoKXsNCiAgICAgIHRoaXMuZ2V0RW1wbG95ZWVJbm5lckxpc3QoKTsNCiAgICAgIGFwaVNlcnZpY2UucG9zdCh1cmxzLmdldCArIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIGxldCByZXMgPSB7DQogICAgICAgICAgU3RhdGlzdGljUmVwb3J0SGVhZGVyRHRvOiByZXNwb25zZS5kYXRhLmhlYWRlciwNCiAgICAgICAgICBTdGF0aXN0aWNSZXBvcnRJbmZvRHRvOiByZXNwb25zZS5kYXRhLmluZm9MaXN0LA0KICAgICAgICB9Ow0KICAgICAgICByZXMuU3RhdGlzdGljUmVwb3J0SW5mb0R0byA9IHRoaXMuc2VyaWFsaXplRW1wbG95ZWVJZHMocmVzLlN0YXRpc3RpY1JlcG9ydEluZm9EdG8pOw0KICAgICAgICBpZiAocmVzLlN0YXRpc3RpY1JlcG9ydEluZm9EdG8ubGVuZ3RoID09PSAxICYmIHJlcy5TdGF0aXN0aWNSZXBvcnRJbmZvRHRvWzBdLmluZm9UeXBlID09PSBudWxsKSB7DQogICAgICAgICAgdGhpcy5pbmZvVHlwZUxpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgIHJlcy5TdGF0aXN0aWNSZXBvcnRJbmZvRHRvW2luZGV4XSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bMF0pKTsNCiAgICAgICAgICAgIHJlcy5TdGF0aXN0aWNSZXBvcnRJbmZvRHRvW2luZGV4XS5pbmZvVHlwZSA9IGl0ZW0uY29kZTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmZvcm0gPSByZXM7DQogICAgICB9KTsNCiAgICAgIGFwaVNlcnZpY2UucG9zdCh1cmxzLnF1YXJ0ZXIsIHsNCiAgICAgICAgaXRlbXNQZXJQYWdlOiAxMDAsDQogICAgICAgIHBhZ2U6IDAsDQogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgdGhpcy5xdWFydGVyTGlzdCA9IHJlc3BvbnNlLmRhdGEubGlzdDsNCiAgICAgIH0pOw0KICAgICAgYXBpU2VydmljZS5wb3N0KHVybHMubWVhc3VyZW1lbnRVbml0LCB7DQogICAgICAgIGl0ZW1zUGVyUGFnZTogMTAwLA0KICAgICAgICBwYWdlOiAwLA0KICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMubWVhc3VyZW1lbnRVbml0TGlzdCA9IHJlc3BvbnNlLmRhdGEubGlzdDsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmhhbmRsZUNyZWF0ZWQoKQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGdldFRhYmxlTWF4Um93czogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIDQgKyAodGhpcy5xdWFydGVyUGxhbkRvbmVMaXN0Lmxlbmd0aCkNCiAgICB9LA0KICAgIHF1YXJ0ZXJQbGFuRG9uZUxpc3QoKSB7DQogICAgICBsZXQgbGlzdCA9IFtdOw0KICAgICAgdGhpcy5xdWFydGVyTGlzdC5mb3JFYWNoKChlLCBpKSA9PiB7DQogICAgICAgIGxpc3QucHVzaCh7Li4uZSwgdHlwZTogJ3BsYW4nLCBxdWFydGVySW5kZXg6IGl9KTsNCiAgICAgICAgbGlzdC5wdXNoKHsuLi5lLCB0eXBlOiAnZG9uZScsIHF1YXJ0ZXJJbmRleDogaX0pOw0KICAgICAgfSk7DQogICAgICByZXR1cm4gbGlzdDsNCiAgICB9LA0KICB9LA0KICB3YXRjaDogew0KICAgICdtb2RhbC5zaG93Jzogew0KICAgICAgaGFuZGxlcih2YWwpIHsNCiAgICAgICAgaWYgKHRoaXMubW9kYWwuc3RlcCA9PT0gJ2Jhc2VzJykgew0KICAgICAgICAgIGlmICh2YWwgPT09IGZhbHNlKSB7DQogICAgICAgICAgICBpZiAodGhpcy5tb2RhbC5iYXNlcyAmJiB0aGlzLm1vZGFsLmJhc2VzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLm1vZGFsLmJhc2VzOw0KICAgICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgICAgICAgICBjb25zdCBxdWFydGVyID0gdGhpcy5xdWFydGVyUGxhbkRvbmVMaXN0W3RoaXMubW9kYWwucXVhcnRlcktleV07DQogICAgICAgICAgICAgIGxldCBpbmZvOw0KICAgICAgICAgICAgICBpZiAodGhpcy5tb2RhbC5jaGlsZEluZGV4ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICBpbmZvID0gdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uY2hpbGRyZW5bdGhpcy5tb2RhbC5jaGlsZEluZGV4XTsNCiAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpbmZvID0gdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF07DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgZmlsZXMuZm9yRWFjaChmaWxlID0+IHsNCiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2Jhc2VGaWxlcycsIGZpbGUuZmlsZSk7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBhcGlTZXJ2aWNlDQogICAgICAgICAgICAgICAgICAucG9zdChNQUlOX0FQSV9VUkwgKyBgL3NhdmUvYmFzZS1maWxlcy8ke2luZm8uaWR9LyR7cXVhcnRlci5pZH1gLCBmb3JtRGF0YSwgew0KICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiwNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGFsLmNoaWxkSW5kZXggIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uY2hpbGRyZW5bdGhpcy5tb2RhbC5jaGlsZEluZGV4XS5iYXNlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uY2hpbGRyZW5bdGhpcy5tb2RhbC5jaGlsZEluZGV4XS5iYXNlcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0uU3RhdGlzdGljUmVwb3J0SW5mb0R0b1t0aGlzLm1vZGFsLnBhcmVudEluZGV4XS5jaGlsZHJlblt0aGlzLm1vZGFsLmNoaWxkSW5kZXhdLmJhc2VzW3RoaXMubW9kYWwucXVhcnRlcktleV0gPSByZXMuZGF0YS5pbmZvRmlsZXM7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmZvcm0uU3RhdGlzdGljUmVwb3J0SW5mb0R0b1t0aGlzLm1vZGFsLnBhcmVudEluZGV4XS5iYXNlcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uYmFzZXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtLlN0YXRpc3RpY1JlcG9ydEluZm9EdG9bdGhpcy5tb2RhbC5wYXJlbnRJbmRleF0uYmFzZXNbdGhpcy5tb2RhbC5xdWFydGVyS2V5XSA9IHJlcy5kYXRhLmluZm9GaWxlczsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmJhc2VzID0gW107DQogICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgIGRlZXA6IHRydWUsDQogICAgfSwNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["Update.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsLA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Update.vue","sourceRoot":"src/modules/excel-table/modules/final-forecast-fill","sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-md-12 text-center\">\r\n      <div class=\"btn btn-outline-dark btn-secondary float-left\"\r\n           @click=\"$router.push({name: 'IndexFinalForecastFill'})\">\r\n        {{ $t('actions.back') }}\r\n      </div>\r\n      <div class=\"h5 mb-4 d-inline-block\">{{ $t('submodules.final_forecast.title') }}</div>\r\n      <div class=\"btn btn-success float-right\" @click=\"save\">{{ $t('actions.save') }}</div>\r\n      <div class=\"btn btn-primary float-right\" @click=\"excelExport\">{{ $t('actions.excel') }}</div>\r\n    </div>\r\n    <div class=\"col-12\">\r\n      <div class=\"card\">\r\n        <div class=\"card-body\">\r\n          <div class=\"row\">\r\n            <div class=\"col-md-12\">\r\n              <table class=\"table table-sm table-bordered table-condensed vertical-align-middle\" ref=\"table\">\r\n                <thead>\r\n                <tr>\r\n                  <th :colspan=\"getTableMaxRows\" class=\"text-center h5\">\r\n                    {{\r\n                      form.StatisticReportHeaderDto ? getName({\r\n                        nameUz: form.StatisticReportHeaderDto.decisionNameUz,\r\n                        nameRu: form.StatisticReportHeaderDto.decisionNameRu,\r\n                        nameLt: form.StatisticReportHeaderDto.decisionNameLt,\r\n                      }) : ''\r\n                    }}\r\n                  </th>\r\n                </tr>\r\n                <tr class=\"text-center\">\r\n                  <th rowspan=\"3\">â„–</th>\r\n                  <th rowspan=\"3\" colspan=\"2\" class=\"text-center\">{{\r\n                      $t('submodules.final_forecast.state_program_and_target_indicator')\r\n                    }}\r\n                  </th>\r\n                  <th rowspan=\"3\">{{ $t('column.unit') }}</th>\r\n                  <th :colspan=\"quarterPlanDoneList.length || 1\" class=\"text-center\">\r\n                    {{\r\n                      $t('submodules.final_forecast.year_plan', {year: form.StatisticReportHeaderDto ? form.StatisticReportHeaderDto.year : ''})\r\n                    }}\r\n                  </th>\r\n                </tr>\r\n                <tr>\r\n                  <th v-for=\"(quarterItem, quarterKey) in quarterList\" :key=\"quarterKey\" class=\"text-center\"\r\n                      colspan=\"2\">\r\n                    {{\r\n                      getName({\r\n                        nameUz: quarterItem.nameUz,\r\n                        nameRu: quarterItem.nameRu,\r\n                        nameLt: quarterItem.nameLt,\r\n                      })\r\n                    }}\r\n                  </th>\r\n                </tr>\r\n                <tr>\r\n                  <th v-for=\"(quarterItem, quarterKey) in quarterPlanDoneList\" :key=\"quarterKey\" class=\"text-center\">\r\n                    {{\r\n                      quarterItem.type === 'plan' ? $t('submodules.final_forecast.plan') : $t('submodules.final_forecast.done')\r\n                    }}\r\n                  </th>\r\n                </tr>\r\n                <tr class=\"text-center\">\r\n                  <th colspan=\"3\">\r\n                    {{\r\n                      form.StatisticReportHeaderDto ? getName({\r\n                        nameUz: form.StatisticReportHeaderDto.organizationNameUz,\r\n                        nameRu: form.StatisticReportHeaderDto.organizationNameRu,\r\n                        nameLt: form.StatisticReportHeaderDto.organizationNameLt,\r\n                      }) : ''\r\n                    }}\r\n                  </th>\r\n                  <th>\r\n                    {{\r\n                      form.StatisticReportHeaderDto ? getName({\r\n                        nameUz: form.StatisticReportHeaderDto.measurementUnitNameUz,\r\n                        nameRu: form.StatisticReportHeaderDto.measurementUnitNameRu,\r\n                        nameLt: form.StatisticReportHeaderDto.measurementUnitNameLt,\r\n                      }) : ''\r\n                    }}\r\n                  </th>\r\n                  <th :colspan=\"quarterPlanDoneList.length || 1\">\r\n                    {{ form.StatisticReportHeaderDto ? form.StatisticReportHeaderDto.value : '' }}\r\n                  </th>\r\n                </tr>\r\n                <tr class=\"text-center\">\r\n                  <td></td>\r\n                  <th :colspan=\"getTableMaxRows-1\">\r\n                    {{\r\n                      form.StatisticReportHeaderDto ? getName({\r\n                        nameUz: form.StatisticReportHeaderDto.strategicPurposeUz,\r\n                        nameRu: form.StatisticReportHeaderDto.strategicPurposeRu,\r\n                        nameLt: form.StatisticReportHeaderDto.strategicPurposeLt,\r\n                      }) : ''\r\n                    }}\r\n                  </th>\r\n                </tr>\r\n                </thead>\r\n                <Info v-for=\"(infoTypeItem, infoTypeKey) in infoTypeList\"\r\n                      :key=\"infoTypeKey\"\r\n                      :infoTypeKey=\"infoTypeKey\"\r\n                      :infoType=\"infoTypeItem\"\r\n                      :statisticReportInfoDto=\"form.StatisticReportInfoDto\"\r\n                      :getTableMaxRows=\"getTableMaxRows\"\r\n                      :quarterList=\"quarterList\"\r\n                      ref=\"infoType\"\r\n                      :quarterPlanDoneList=\"quarterPlanDoneList\"\r\n                      :measurementUnitList=\"measurementUnitList\"\r\n                      :measurementUnitMap=\"measurementUnitMap\"\r\n                      @open-parent-modal=\"openModal\"\r\n                      @confirm-quarter-value=\"confirmQuarterValue\"\r\n                />\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <b-modal id=\"modal-1\"\r\n             :title=\"modal.title\"\r\n             v-model=\"modal.show\"\r\n             ref=\"modal\">\r\n      <div v-if=\"modal.step === 'quarter_plan'\">\r\n        <div class=\"form-group\">\r\n          <label>{{ $t('column.value') }}</label>\r\n          <input class=\"form-control\"\r\n                 type=\"number\"\r\n                 ref=\"quarter_plan\"\r\n                 step=\"any\"\r\n                 v-model=\"form.StatisticReportInfoDto[modal.parentIndex].children[modal.childIndex].quarterValueDtoList[modal.quarterKey].done\"/>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"modal.step === 'bases'\">\r\n        <div class=\"form-group\">\r\n          <BaseFileUploaderWithValidation\r\n              not-required\r\n              ref=\"supplementDocUploader\"\r\n              v-model=\"modal.bases\"\r\n              :max-files=\"null\"\r\n              :max-fileSize=\"null\"\r\n              :label-on-top=\"false\"\r\n              :label=\"$t('attached_files')\"\r\n          ></BaseFileUploaderWithValidation>\r\n        </div>\r\n        <div v-if=\"this.modal.childIndex !== undefined\">\r\n          <div\r\n              v-if=\"form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases && form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases[modal.quarterKey]\"\r\n              class=\"d-inline-block\">\r\n            <div\r\n                v-for=\"(items, keys) in form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases[modal.quarterKey]\"\r\n                :key=\"keys\" class=\"d-inline-block\">\r\n              <a :href=\"'/'+items.url\" download class=\"btn\"><i class=\"mdi mdi-download\"></i> {{ items.name }}</a>\r\n            </div>\r\n          </div>\r\n          <div\r\n              v-for=\"(items, keys) in form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].quarterValueDtoList[modal.quarterKey].baseFiles\"\r\n              :key=\"keys\" class=\"d-inline-block\">\r\n            <a :href=\"'/'+items.url\" download class=\"btn\"><i class=\"mdi mdi-download\"></i> {{ items.name }}</a>\r\n          </div>\r\n        </div>\r\n        <div v-else>\r\n          <div v-if=\"form.StatisticReportInfoDto[this.modal.parentIndex].bases && form.StatisticReportInfoDto[this.modal.parentIndex].bases[modal.quarterKey]\"\r\n               class=\"d-inline-block\">\r\n            <div v-for=\"(items, keys) in form.StatisticReportInfoDto[this.modal.parentIndex].bases[modal.quarterKey]\"\r\n                 :key=\"keys\" class=\"d-inline-block\">\r\n              <a :href=\"'/'+items.url\" download class=\"btn\"><i class=\"mdi mdi-download\"></i> {{ items.name }}</a>\r\n            </div>\r\n            <div\r\n                v-for=\"(items, keys) in form.StatisticReportInfoDto[this.modal.parentIndex].quarterValueDtoList[modal.quarterKey].baseFiles\"\r\n                :key=\"keys\" class=\"d-inline-block\">\r\n              <a :href=\"'/'+items.url\" download class=\"btn\"><i class=\"mdi mdi-download\"></i> {{ items.name }}</a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <template #modal-footer>\r\n        <button type=\"button\" class=\"btn btn-primary\" @click=\"modal.show = false;\">{{ $t('actions.save') }}</button>\r\n      </template>\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport i18n from \"../../../../i18n\";\r\n\r\nconst MAIN_API_URL = 'statistic-report'\r\n\r\nimport Info from \"./Info\";\r\nimport appConfig from \"@/app.config\";\r\nimport apiService from \"@/shared/services/api.service\";\r\nimport XLSX from \"xlsx\";\r\n\r\nconst urls = {\r\n  create: MAIN_API_URL + '/create',\r\n  update: MAIN_API_URL + '/update/',\r\n  saveValue: MAIN_API_URL + '/save-value',\r\n  get: MAIN_API_URL + '/get-by-id/',\r\n  quarter: MAIN_API_URL + '/directory/quarter/list-search',\r\n  measurementUnit: MAIN_API_URL + '/directory/measurement-unit/list-search',\r\n  innerEmployee: '/employee/list-search/inner',\r\n  confirmQuarterValue: '/statistic-report/confirm-quarter-value/',\r\n}\r\n\r\nexport default {\r\n  page: {\r\n    title: i18n.t('submodules.final_forecast.title'),\r\n    meta: [{name: \"description\", content: appConfig.description}],\r\n  },\r\n  components: {\r\n    Info,\r\n  },\r\n  data() {\r\n    return {\r\n      form: {},\r\n      modal: {\r\n        show: false,\r\n        step: '',\r\n        title: \"\",\r\n        infoTypeKey: '',\r\n        parentIndex: 0,\r\n        childIndex: undefined,\r\n        quarterKey: undefined,\r\n        bases: undefined,\r\n      },\r\n      infoTypeList: [\r\n        {\r\n          code: 'FINAL',\r\n          name: i18n.t('submodules.final_forecast.info_type_final'),\r\n        },\r\n        {\r\n          code: 'DIRECTLY',\r\n          name: i18n.t('submodules.final_forecast.info_type_directly'),\r\n        },\r\n      ],\r\n      quarterList: [],\r\n      measurementUnitList: [],\r\n      measurementUnitMap: {},\r\n      employeeListKeyword: '',\r\n      employeeList: [],\r\n      employeeListMap: {},\r\n      saveLoading: false,\r\n    };\r\n  },\r\n  methods: {\r\n    getEmployeeInnerList() {\r\n      apiService.post(urls.innerEmployee + '?keyword=' + encodeURIComponent(this.employeeListKeyword), {\r\n        itemsPerPage: 10,\r\n        page: 0,\r\n      }).then(res => {\r\n        this.employeeList = res.data.list;\r\n        this.employeeListMap = {};\r\n        this.employeeList.forEach(item => {\r\n          this.employeeListMap[item.id] = item;\r\n        });\r\n      });\r\n    },\r\n    openModal(show, step, infoTypeKey, parentIndex, childIndex, quarterKey = undefined) {\r\n      console.log(show, step, infoTypeKey, parentIndex, childIndex, quarterKey)\r\n      this.modal.show = show;\r\n      this.modal.step = step;\r\n      this.modal.infoTypeKey = infoTypeKey;\r\n      this.modal.parentIndex = parentIndex;\r\n      this.modal.childIndex = childIndex;\r\n      this.modal.quarterKey = quarterKey;\r\n    },\r\n    customLabelAdDesignType(id) {\r\n      let selected = this.employeeListMap[id];\r\n      if (selected) {\r\n        return selected.fullName;\r\n      }\r\n      return '';\r\n    },\r\n    customLabelMeasurementUnitList(id) {\r\n      let selected = this.measurementUnitList[id];\r\n      if (selected) {\r\n        return this.getName({});\r\n      }\r\n      return '';\r\n    },\r\n    onEmployeeChange(selectedList) {\r\n      if (this.modal.step === 'employee_child') {\r\n        this.form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].employeeFullNames = selectedList.map(e => {\r\n          return this.employeeListMap[e].lastName + ' ' + this.employeeNameFirstChar(this.employeeListMap[e].firstName) + ' ' + this.employeeNameFirstChar(this.employeeListMap[e].middleName);\r\n        });\r\n      } else if (this.modal.step === 'employee') {\r\n        this.form.StatisticReportInfoDto[this.modal.parentIndex].employeeFullNames = selectedList.map(e => {\r\n          return this.employeeListMap[e].lastName + ' ' + this.employeeNameFirstChar(this.employeeListMap[e].firstName) + ' ' + this.employeeNameFirstChar(this.employeeListMap[e].middleName);\r\n        });\r\n      }\r\n      this.$refs['infoType'][this.modal.infoTypeKey].serializeItems()\r\n    },\r\n    employeeNameFirstChar(name) {\r\n      let fs = name.charAt(0) + name.charAt(1);\r\n      if (['sh', 'ch', \"o'\", \"g'\"].indexOf(fs.toLowerCase().replace('`', \"'\")) !== -1) {\r\n        return fs;\r\n      }\r\n      return name.charAt(0);\r\n    },\r\n    save() {\r\n      if (this.saveLoading) {\r\n        return;\r\n      }\r\n      this.saveLoading = true;\r\n      let data = this.serializeSaveResult(this.form.StatisticReportInfoDto);\r\n      apiService.post(urls.saveValue, data, true).then(res => {\r\n        this.$toast(this.$t('messages.saved_successfully'), {\r\n          type: 'success'\r\n        });\r\n        this.saveLoading = false;\r\n        this.$router.push({name: 'IndexFinalForecastFill'});\r\n      }).catch(err => {\r\n        this.saveLoading = false;\r\n      });\r\n    },\r\n    serializeSaveResult(infos, result = []) {\r\n      for (const index in infos) {\r\n        infos[index].quarterValueDtoList.map(e => {\r\n          result.push({\r\n            id: e.id,\r\n            done: e.done,\r\n            quarterId: e.quarterId,\r\n          });\r\n        });\r\n        if (infos[index].children) {\r\n          result = this.serializeSaveResult(infos[index].children, result);\r\n        }\r\n      }\r\n      return result;\r\n    },\r\n    serializeEmployeeIds(infoList) {\r\n      return infoList.map(info => {\r\n        info.employeeIds = info.attachedEmployeeDtos.map(e => {\r\n          return e.employeeId;\r\n        });\r\n        info.employeeFullNames = info.attachedEmployeeDtos.map(e => {\r\n          return e.employeeLastName + ' ' + e.employeeFirstName + ' ' + e.employeeMiddleName;\r\n        });\r\n        if (info.children) {\r\n          info.children = this.serializeEmployeeIds(info.children);\r\n        }\r\n        return info;\r\n      });\r\n    },\r\n    excelExport() {\r\n      this.loaderExcel = true;\r\n      let fileName = `Report`;\r\n      let wb = XLSX.utils.table_to_book(this.$refs.table, {sheet: \"sheet1\"});\r\n      setTimeout(() => {\r\n        this.loaderExcel = false;\r\n      }, 500);\r\n      return XLSX.writeFile(wb, `${fileName}.xlsx`, {});\r\n    },\r\n    confirmQuarterValue({id}) {\r\n      this.cnf().then(({value}) => {\r\n        if (value) {\r\n          apiService.post(urls.confirmQuarterValue + id, {}, true).then(async res => {\r\n            await this.handleCreated()\r\n            await this.$toast(this.$t('success'), {\r\n              type: 'success'\r\n            });\r\n          }).catch(err => {\r\n          });\r\n        }\r\n      })\r\n    },\r\n    handleCreated(){\r\n      this.getEmployeeInnerList();\r\n      apiService.post(urls.get + this.$route.params.id).then(response => {\r\n        let res = {\r\n          StatisticReportHeaderDto: response.data.header,\r\n          StatisticReportInfoDto: response.data.infoList,\r\n        };\r\n        res.StatisticReportInfoDto = this.serializeEmployeeIds(res.StatisticReportInfoDto);\r\n        if (res.StatisticReportInfoDto.length === 1 && res.StatisticReportInfoDto[0].infoType === null) {\r\n          this.infoTypeList.forEach((item, index) => {\r\n            res.StatisticReportInfoDto[index] = JSON.parse(JSON.stringify(res.StatisticReportInfoDto[0]));\r\n            res.StatisticReportInfoDto[index].infoType = item.code;\r\n          });\r\n        }\r\n        this.form = res;\r\n      });\r\n      apiService.post(urls.quarter, {\r\n        itemsPerPage: 100,\r\n        page: 0,\r\n      }).then(response => {\r\n        this.quarterList = response.data.list;\r\n      });\r\n      apiService.post(urls.measurementUnit, {\r\n        itemsPerPage: 100,\r\n        page: 0,\r\n      }).then(response => {\r\n        this.measurementUnitList = response.data.list;\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.handleCreated()\r\n  },\r\n  computed: {\r\n    getTableMaxRows: function () {\r\n      return 4 + (this.quarterPlanDoneList.length)\r\n    },\r\n    quarterPlanDoneList() {\r\n      let list = [];\r\n      this.quarterList.forEach((e, i) => {\r\n        list.push({...e, type: 'plan', quarterIndex: i});\r\n        list.push({...e, type: 'done', quarterIndex: i});\r\n      });\r\n      return list;\r\n    },\r\n  },\r\n  watch: {\r\n    'modal.show': {\r\n      handler(val) {\r\n        if (this.modal.step === 'bases') {\r\n          if (val === false) {\r\n            if (this.modal.bases && this.modal.bases.length > 0) {\r\n              const files = this.modal.bases;\r\n              const formData = new FormData();\r\n              const quarter = this.quarterPlanDoneList[this.modal.quarterKey];\r\n              let info;\r\n              if (this.modal.childIndex !== undefined) {\r\n                info = this.form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex];\r\n              } else {\r\n                info = this.form.StatisticReportInfoDto[this.modal.parentIndex];\r\n              }\r\n              files.forEach(file => {\r\n                formData.append('baseFiles', file.file);\r\n              });\r\n              apiService\r\n                  .post(MAIN_API_URL + `/save/base-files/${info.id}/${quarter.id}`, formData, {\r\n                    headers: {\r\n                      \"Content-Type\": \"multipart/form-data\",\r\n                    },\r\n                  })\r\n                  .then((res) => {\r\n                    if (this.modal.childIndex !== undefined) {\r\n                      if (!this.form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases) {\r\n                        this.form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases = [];\r\n                      }\r\n                      this.form.StatisticReportInfoDto[this.modal.parentIndex].children[this.modal.childIndex].bases[this.modal.quarterKey] = res.data.infoFiles;\r\n                    } else {\r\n                      if (!this.form.StatisticReportInfoDto[this.modal.parentIndex].bases) {\r\n                        this.form.StatisticReportInfoDto[this.modal.parentIndex].bases = [];\r\n                      }\r\n                      this.form.StatisticReportInfoDto[this.modal.parentIndex].bases[this.modal.quarterKey] = res.data.infoFiles;\r\n                    }\r\n                    this.modal.bases = [];\r\n                  })\r\n                  .catch((err) => {\r\n                    console.log(err);\r\n                  });\r\n            }\r\n          }\r\n        }\r\n      },\r\n      deep: true,\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n.vertical-align-middle th, .vertical-align-middle td {\r\n  vertical-align: middle;\r\n}\r\n\r\n.preview {\r\n  max-width: 60px;\r\n  max-height: 60px;\r\n  border-radius: 5px;\r\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);\r\n}\r\n</style>"]}]}