{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\products\\petrol-stations\\modules\\list_and_crud\\CreateOrUpdate.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\products\\petrol-stations\\modules\\list_and_crud\\CreateOrUpdate.vue","mtime":1682419455884},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9BQ1JVIFBST0pFQ1QvRmFpciBUZWNoL2FjcnUtZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5LmpzIjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci50by1maXhlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwp2YXIgTUFJTl9BUElfVVJMID0gJ3BldHJvbCc7CnZhciBBUFBFTkRfQVBJX1VSTF9GT1JfR09WRVJOTUVOVCA9ICdieS1maXJzdC1hZ2VudCc7Ci8qDQoqIFlPVSBNVVNUIFNFTkQge3sgTUFJTl9BUElfVVJMIH19IFRPIENSVURfU0VSVklDRSAqLwppbXBvcnQgY3J1ZEFuZExpc3RzU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9jcnVkX2FuZF9saXN0LnNlcnZpY2UiOwppbXBvcnQgaGVscGVyU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSI7CmltcG9ydCBNYXBJbk1vZGFsIGZyb20gJy4vY29tcG9uZW50cy9NYXBJbk1vZGFsJzsKaW1wb3J0IENyZWF0ZUZvcm1Db250cmFjdG9yIGZyb20gJ0Avc2hhcmVkL3ZpZXdzL2NvbXBvbmVudHMvQ3JlYXRlRm9ybUNvbnRyYWN0b3InOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkNyZWF0ZU9yVXBkYXRlIiwKICAvKg0KICAqIENPTVBPTkVOVFMgKi8KICBjb21wb25lbnRzOiB7CiAgICBNYXBJbk1vZGFsOiBNYXBJbk1vZGFsLAogICAgQ3JlYXRlRm9ybUNvbnRyYWN0b3I6IENyZWF0ZUZvcm1Db250cmFjdG9yCiAgfSwKICAvKg0KICAqIERBVEEgKi8KICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbm90Rm9ybWF0dGVkTW9udGhseVBheW1lbnQ6IG51bGwsCiAgICAgIGFkU2lkZVZhbHVlOiBudWxsLAogICAgICBkaXN0cmljdE1vZGFsOiBmYWxzZSwKICAgICAgcXVhcnRlcnNNb2RhbDogZmFsc2UsCiAgICAgIHN0cmVldHNNb2RhbDogZmFsc2UsCiAgICAgIG1hcE1vZGFsOiBmYWxzZSwKICAgICAgZWRpdGluZ0l0ZW06IHsKICAgICAgICBhZGRyZXNzRHRvOiB7fQogICAgICB9LAogICAgICBoYXNOZXh0UGFnZUNvbnRyYWN0b3JzOiBmYWxzZSwKICAgICAgY29udHJhY3RvcnM6IFtdLAogICAgICBkZWJvdW5jZTogbnVsbCwKICAgICAgaXNMb2FkaW5nQ29udHJhY3RvcnM6IGZhbHNlLAogICAgICBkaXN0cmljdHM6IFtdLAogICAgICBxdWFydGVyczogW10sCiAgICAgIHN0cmVldHM6IFtdLAogICAgICBhZFR5cGVzOiBbXSwKICAgICAgYWRHcm91cHM6IFtdLAogICAgICBhZFpvbmVzOiBbXSwKICAgICAgYWRTaWRlczogW10sCiAgICAgIGFkVm9sdW1lVHlwZXM6IFtdLAogICAgICBsb2NhbFBhc3Nwb3J0RXhwaXJlRGF0ZTogW10sCiAgICAgIGNvbnRyYWN0b3JDcmVhdGVNb2RhbDogZmFsc2UsCiAgICAgIG1pbkNvbGxlY3Rpb25WYWx1ZTogbnVsbCwKICAgICAgY29lZmZpY2llbnRWYWx1ZTogbnVsbCwKICAgICAgY29udHJhY3Rvck5vdEZvdW5kOiBmYWxzZSwKICAgICAgY29udHJhY3RvclNlYXJjaFBheWxvYWQ6IHt9LAogICAgICBjaGVja1Bhc3Nwb3J0TnVtYmVyTG9hZGluZzogZmFsc2UsCiAgICAgIGRiUGFzc3BvcnROdW1iZXI6ICcnLAogICAgICBpc1Bhc3Nwb3J0TnVtYmVySW52YWxpZDogZmFsc2UsCiAgICAgIG1pbmltdW1Db2xsZWN0aW9uczogW10sCiAgICAgIGNyZWF0ZU11bHRpcGxlTWluaW11bUNvbGxlY3Rpb25zTW9kYWw6IGZhbHNlLAogICAgICBzaW5nbGVNaW5pbXVtQ29sbGVjdGlvblVwZGF0ZU1vZGFsOiBmYWxzZSwKICAgICAgc3RhdHVzZXM6IFtdLAogICAgICByZWdpb25zOiBbXSwKICAgICAgdW5pdHM6IFtdLAogICAgICBhZExvY2F0aW9uVHlwZXM6IFtdLAogICAgICBhZERlc2lnblR5cGVzOiBbXSwKICAgICAgYWRPYmplY3RTdGF0ZXM6IFtdLAogICAgICBkcm9wem9uZU9wdGlvbnM6IHsKICAgICAgICB1cmw6ICJodHRwczovL2h0dHBiaW4ub3JnL3Bvc3QiLAogICAgICAgIGRpY3REZWZhdWx0TWVzc2FnZTogJ+ODleOCoeOCpOODq+OCkuODieODreODg+ODl+OBl+OBpuOBj+OBoOOBleOBhC4nLAogICAgICAgIHRodW1ibmFpbFdpZHRoOiAxNTAsCiAgICAgICAgbWF4RmlsZXNpemU6IDEuMCwKICAgICAgICBhZGRSZW1vdmVMaW5rczogdHJ1ZSwKICAgICAgICBkaWN0UmVtb3ZlRmlsZTogJ3gnLAogICAgICAgIG1heEZpbGVzOiAzCiAgICAgIH0sCiAgICAgIGFyY2hpdGVjdERvY0ZpbGU6IHt9LAogICAgICBwaG90bzoge30sCiAgICAgIHBhc3Nwb3J0RG9jRmlsZToge30sCiAgICAgIHBhc3Nwb3J0UGhvdG86IHt9LAogICAgICBwYXltZW50RG9jRmlsZToge30KICAgIH07CiAgfSwKICAvKg0KICAqIENPTVBVVEVEICovCiAgY29tcHV0ZWQ6IHsKICAgIGlucHV0TWluVmFsdWU6IGZ1bmN0aW9uIGlucHV0TWluVmFsdWUodmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlLmVkaXRpbmdJdGVtLnBhc3Nwb3J0R2l2ZW5EYXRlOwogICAgfSwKICAgIGlucHV0TWF4VmFsdWU6IGZ1bmN0aW9uIGlucHV0TWF4VmFsdWUodmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlLmVkaXRpbmdJdGVtLnBhc3Nwb3J0RXhwaXJlRGF0ZTsKICAgIH0sCiAgICBpc01vZGVDcmVhdGU6IGZ1bmN0aW9uIGlzTW9kZUNyZWF0ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLm5hbWUgPT0gJ0NyZWF0ZVBldHJvbFN0YXRpb24nOwogICAgfSwKICAgIGNvbXB1dGVkT2JzZXJ2ZXI6IGZ1bmN0aW9uIGNvbXB1dGVkT2JzZXJ2ZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyZWZzLm9ic2VydmVyOwogICAgfQogIH0sCiAgLyoNCiAgKiBNRVRIT0RTICovCiAgbWV0aG9kczogewogICAgZmluZEFuZFNldEFkVm9sdW1lVHlwZTogZnVuY3Rpb24gZmluZEFuZFNldEFkVm9sdW1lVHlwZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5lZGl0aW5nSXRlbS5kaXJlY3RvcnlBZHZlcnRpc2VtZW50Vm9sdW1lVHlwZUlkID0gbnVsbDsKICAgICAgaWYgKHRoaXMuZWRpdGluZ0l0ZW0udm9sdW1lKSB7CiAgICAgICAgdGhpcy5hZFZvbHVtZVR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHZUeXBlKSB7CiAgICAgICAgICBpZiAocGFyc2VGbG9hdChfdGhpcy5lZGl0aW5nSXRlbS52b2x1bWUpID49IHZUeXBlLm1pbkJvcmRlciAmJiBwYXJzZUZsb2F0KF90aGlzLmVkaXRpbmdJdGVtLnZvbHVtZSkgPD0gdlR5cGUubWF4Qm9yZGVyKSB7CiAgICAgICAgICAgIF90aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeUFkdmVydGlzZW1lbnRWb2x1bWVUeXBlSWQgPSB2VHlwZS5pZDsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLmFkVm9sdW1lVHlwZVNlbGVjdGVkKHRoaXMuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5QWR2ZXJ0aXNlbWVudFZvbHVtZVR5cGVJZCk7CiAgICB9LAogICAgYWRTaWRlU2VsZWN0ZWQ6IGZ1bmN0aW9uIGFkU2lkZVNlbGVjdGVkKCRldmVudCkgewogICAgICB2YXIgZm91bmRBZFNpZGUgPSB0aGlzLmFkU2lkZXMuZmluZChmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwuaWQgPT0gJGV2ZW50OwogICAgICB9KTsKICAgICAgdGhpcy5hZFNpZGVWYWx1ZSA9IGZvdW5kQWRTaWRlID8gZm91bmRBZFNpZGUuY29kZSA6IG51bGw7CiAgICAgIHRoaXMuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgIH0sCiAgICBhZFZvbHVtZVR5cGVTZWxlY3RlZDogZnVuY3Rpb24gYWRWb2x1bWVUeXBlU2VsZWN0ZWQoJGV2ZW50KSB7CiAgICAgIHRoaXMuZ2V0TWluQ29sbGVjdGlvblZhbHVlKHRoaXMuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5yZWdpb25JZCwgdGhpcy5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLmRpc3RyaWN0SWQsIHRoaXMuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5QWR2ZXJ0aXNlbWVudExvY2F0aW9uVHlwZUlkLCB0aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeUFkdmVydGlzZW1lbnREZXNpZ25UeXBlSWQsICRldmVudCk7CiAgICB9LAogICAgY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQ6IGZ1bmN0aW9uIGNhbGN1bGF0ZUFuZFNldE1vbnRobHlQYXltZW50KCkgewogICAgICB0aGlzLiRzZXQodGhpcy5lZGl0aW5nSXRlbSwgJ21vbnRobHlQYXltZW50JywgbnVsbCk7CiAgICAgIHRoaXMubm90Rm9ybWF0dGVkTW9udGhseVBheW1lbnQgPSBudWxsOwogICAgICBpZiAodGhpcy5taW5Db2xsZWN0aW9uVmFsdWUgJiYgdGhpcy5jb2VmZmljaWVudFZhbHVlICYmIHRoaXMuZWRpdGluZ0l0ZW0uZGVzaWduVHlwZVByaXZpbGVnZUNvZWZmaWNpZW50ICYmIHRoaXMuZWRpdGluZ0l0ZW0udm9sdW1lICYmIHRoaXMuYWRTaWRlVmFsdWUpIHsKICAgICAgICB2YXIgbnVtID0gKHBhcnNlRmxvYXQodGhpcy5taW5Db2xsZWN0aW9uVmFsdWUpICogcGFyc2VGbG9hdCh0aGlzLmNvZWZmaWNpZW50VmFsdWUpICogcGFyc2VGbG9hdCh0aGlzLmVkaXRpbmdJdGVtLmRlc2lnblR5cGVQcml2aWxlZ2VDb2VmZmljaWVudCkgKiBwYXJzZUZsb2F0KHRoaXMuZWRpdGluZ0l0ZW0udm9sdW1lKSAqIHBhcnNlRmxvYXQodGhpcy5hZFNpZGVWYWx1ZSkpLnRvRml4ZWQoMik7CiAgICAgICAgdGhpcy5ub3RGb3JtYXR0ZWRNb250aGx5UGF5bWVudCA9IG51bTsKICAgICAgICB2YXIgZm9ybWF0dGVkUGF5bWVudFZhbHVlID0gdGhpcy5nZXROdW1iZXJGb3JtYXQobnVtKTsKICAgICAgICB0aGlzLiRzZXQodGhpcy5lZGl0aW5nSXRlbSwgJ21vbnRobHlQYXltZW50JywgZm9ybWF0dGVkUGF5bWVudFZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy5lZGl0aW5nSXRlbSwgJ21vbnRobHlQYXltZW50JywgbnVsbCk7CiAgICAgICAgdGhpcy5ub3RGb3JtYXR0ZWRNb250aGx5UGF5bWVudCA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBnZXRQcml2aWxlZ2VDb2VmZmljaWVudFZhbHVlQnlBZERlc2lnblR5cGVJZDogZnVuY3Rpb24gZ2V0UHJpdmlsZWdlQ29lZmZpY2llbnRWYWx1ZUJ5QWREZXNpZ25UeXBlSWQoYWREZXNpZ25UeXBlSWQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIGlmIChhZERlc2lnblR5cGVJZCkgewogICAgICAgIGhlbHBlclNlcnZpY2UuZ2V0UHJpdmlsZWdlQ29lZmZpY2llbnRWYWx1ZUJ5QWREZXNpZ25UeXBlSWQoYWREZXNpZ25UeXBlSWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgX3RoaXMyLmVkaXRpbmdJdGVtLmRlc2lnblR5cGVQcml2aWxlZ2VDb2VmZmljaWVudCA9IHJlcy5kYXRhOwogICAgICAgICAgX3RoaXMyLmNhbGN1bGF0ZUFuZFNldE1vbnRobHlQYXltZW50KCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG5ld1JlZkNyZWF0ZWQ6IGZ1bmN0aW9uIG5ld1JlZkNyZWF0ZWQobmV3T3B0aW9ucywgbmV3SWQsIGZvcm1OYW1lKSB7CiAgICAgIGlmIChmb3JtTmFtZSA9PSAnQ3JlYXRlRm9ybUdlb1JlZ2lvblF1YXJ0ZXJzJykgewogICAgICAgIHRoaXMucXVhcnRlcnMgPSBuZXdPcHRpb25zOwogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5xdWFydGVySWQgPSBuZXdJZDsKICAgICAgfSBlbHNlIGlmIChmb3JtTmFtZSA9PSAnQ3JlYXRlRm9ybUdlb1JlZ2lvblN0cmVldHMnKSB7CiAgICAgICAgdGhpcy5zdHJlZXRzID0gbmV3T3B0aW9uczsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8uc3RyZWV0SWQgPSBuZXdJZDsKICAgICAgfQogICAgfSwKICAgIG9uQmx1clBhc3Nwb3J0TnVtYmVySW5wdXQ6IGZ1bmN0aW9uIG9uQmx1clBhc3Nwb3J0TnVtYmVySW5wdXQodmFsdWUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWYgKCFfdGhpczMuaXNQYXNzcG9ydE51bWJlckludmFsaWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuY2hlY2tBZFBhc3Nwb3J0TnVtYmVyKHZhbHVlLCB0cnVlKTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGRlYm91bmNlQ2hlY2tQYXNzcG9ydE51bWJlcjogZnVuY3Rpb24gZGVib3VuY2VDaGVja1Bhc3Nwb3J0TnVtYmVyKHNlYXJjaFRleHQpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXM0LmRlYm91bmNlKTsKICAgICAgICAgICAgICBfdGhpczQuZGVib3VuY2UgPSBzZXRUaW1lb3V0KCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LmNoZWNrQWRQYXNzcG9ydE51bWJlcihzZWFyY2hUZXh0KTsKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgICAgICAgICAgfSkpLCAxMDAwKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY2hlY2tBZFBhc3Nwb3J0TnVtYmVyOiBmdW5jdGlvbiBjaGVja0FkUGFzc3BvcnROdW1iZXIoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB2YXIgc2VhcmNoUXVlcnkgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICIiOwogICAgICB2YXIgZnJvbU9uQmx1ciA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIC8qDQogICAgICAgKiBBVk9JRCBNVUxUSVBMRSBSRVFVRVNUUyBBVCBPTkNFICovCiAgICAgIGlmICghdGhpcy5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnJlZ2lvbklkIHx8ICFzZWFyY2hRdWVyeSB8fCB0aGlzLmNoZWNrUGFzc3BvcnROdW1iZXJMb2FkaW5nIHx8ICF0aGlzLmlzTW9kZUNyZWF0ZSAmJiB0aGlzLmVkaXRpbmdJdGVtLnBhc3Nwb3J0TnVtYmVyID09IHRoaXMuZGJQYXNzcG9ydE51bWJlcikgcmV0dXJuOwogICAgICB0aGlzLmNoZWNrUGFzc3BvcnROdW1iZXJMb2FkaW5nID0gdHJ1ZTsKICAgICAgaGVscGVyU2VydmljZS5jaGVja0FkUGFzc3BvcnROdW1iZXJCeVJlZ2lvbihzZWFyY2hRdWVyeSwgdGhpcy5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnJlZ2lvbklkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczUuaXNQYXNzcG9ydE51bWJlckludmFsaWQgPSByZXMuZGF0YTsKICAgICAgICBpZiAoX3RoaXM1LmlzUGFzc3BvcnROdW1iZXJJbnZhbGlkKSB7CiAgICAgICAgICBfdGhpczUuY29tcHV0ZWRPYnNlcnZlci5zZXRFcnJvcnMoewogICAgICAgICAgICBQYXNzcG9ydE51bWJlcjogW190aGlzNS4kdCgndmFsaWRhdG9yLmFkX3Bhc3Nwb3J0X251bWJlcl9hbHJlYWR5X2luX3VzZScpXQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczUuY2hlY2tQYXNzcG9ydE51bWJlckxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAvKg0KICAgICAgICAgICAqIEZPWURBTEFOVVZDSEkgWU9aQVlPVEdBTiBCTydMU0EgSU5QVVROSSBRQVlUQSBGT0NVUyBRSUwgKE9OX0JMVVIgRVZFTlREQU4gQk8nTFNBIEZPQ1VTIFFJTE1BKSAqLwogICAgICAgIGlmICghZnJvbU9uQmx1cikgewogICAgICAgICAgdmFyIHBhc3Nwb3J0TnVtYmVySW5wdXQgPSBfdGhpczUuJHJlZnMucGFzc3BvcnROdW1iZXIuJGVsLnF1ZXJ5U2VsZWN0b3IoImlucHV0Iik7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcGFzc3BvcnROdW1iZXJJbnB1dC5mb2N1cygpOwogICAgICAgICAgfSwgNTApOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc2F2ZUxvY2F0aW9uOiBmdW5jdGlvbiBzYXZlTG9jYXRpb24oZSkgewogICAgICB0aGlzLiRzZXQodGhpcy5lZGl0aW5nSXRlbSwgJ2xhdE51bWJlcicsIGUubGF0KTsKICAgICAgdGhpcy4kc2V0KHRoaXMuZWRpdGluZ0l0ZW0sICdsbmdOdW1iZXInLCBlLmxuZyk7CiAgICAgIHRoaXMubWFwTW9kYWwgPSBmYWxzZTsKICAgIH0sCiAgICBkcmF3Q3JlYXRlZDogZnVuY3Rpb24gZHJhd0NyZWF0ZWQoZSkgewogICAgICB2YXIgdHlwZSA9IGUubGF5ZXJUeXBlLAogICAgICAgIGxheWVyID0gZS5sYXllcjsKICAgICAgaWYgKHR5cGUgPT09ICdtYXJrZXInKSB7CiAgICAgICAgbGF5ZXIuYmluZFBvcHVwKCdBIHBvcHVwIScpOwogICAgICB9CiAgICAgIHRoaXMuZmVhdHVyZUdyb3VwLmFkZExheWVyKGxheWVyKTsKICAgIH0sCiAgICBvcGVuTWFwTW9kYWw6IGZ1bmN0aW9uIG9wZW5NYXBNb2RhbCgpIHsKICAgICAgdGhpcy5tYXBNb2RhbCA9IHRydWU7CiAgICB9LAogICAgY29udHJhY3RvclNhdmVkOiBmdW5jdGlvbiBjb250cmFjdG9yU2F2ZWQocmVzKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXM2LmNvbnRyYWN0b3JDcmVhdGVNb2RhbCA9IGZhbHNlOwogICAgICAgICAgICAgIF90aGlzNi5jb250cmFjdG9yTm90Rm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5mZXRjaENvbnRyYWN0b3JzV2l0aEtleXdvcmQoJycsIHRydWUpOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjcmVhdGVDb250cmFjdG9yOiBmdW5jdGlvbiBjcmVhdGVDb250cmFjdG9yKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB0aGlzLiRyZWZzLmNyZWF0ZUZvcm1Db250cmFjdG9yLnNhdmUoKTsKICAgIH0sCiAgICB2YWxpZGF0ZUlubjogZnVuY3Rpb24gdmFsaWRhdGVJbm4oKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICBoZWxwZXJTZXJ2aWNlLnZhbGlkYXRlSW5uRnJvbUFwaSh0aGlzLmVkaXRpbmdJdGVtLmlubikudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKCFyZXMuZGF0YSkgewogICAgICAgICAgX3RoaXM3LmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsKICAgICAgICAgICAgSU5OOiBbX3RoaXM3LiR0KCd2YWxpZGF0b3IuaW5uJyldCiAgICAgICAgICB9KTsKICAgICAgICAgIF90aGlzNy5jb250cmFjdG9yU2VsZWN0ZWQobnVsbCwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRTaW5nbGVDb250cmFjdG9yQnlJbm46IGZ1bmN0aW9uIGdldFNpbmdsZUNvbnRyYWN0b3JCeUlubigpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CiAgICAgIGlmICh0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIuZmllbGRzLklOTi52YWxpZCkgewogICAgICAgIGhlbHBlclNlcnZpY2UudmFsaWRhdGVJbm5Gcm9tQXBpKHRoaXMuZWRpdGluZ0l0ZW0uaW5uKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIGlmIChyZXMuZGF0YSkgewogICAgICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldFNpbmdsZUNvbnRyYWN0b3JCeUlubihfdGhpczguZWRpdGluZ0l0ZW0uaW5uKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczguY29udHJhY3Rvck5vdEZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgX3RoaXM4LmNvbnRyYWN0b3JTZWxlY3RlZChyZXMuZGF0YSwgZmFsc2UsIHRydWUpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIF90aGlzOC5jb250cmFjdG9yTm90Rm91bmQgPSB0cnVlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzOC5jb21wdXRlZE9ic2VydmVyLnNldEVycm9ycyh7CiAgICAgICAgICAgICAgSU5OOiBbX3RoaXM4LiR0KCd2YWxpZGF0b3IuaW5uJyldCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfdGhpczguY29udHJhY3RvclNlbGVjdGVkKG51bGwsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZVdpZHRoTGVuZ3RoSW5wdXQ6IGZ1bmN0aW9uIGhhbmRsZVdpZHRoTGVuZ3RoSW5wdXQod2lkdGhPckxlbmd0aCkgewogICAgICBpZiAodGhpcy5lZGl0aW5nSXRlbS53aWR0aCAmJiB0aGlzLmVkaXRpbmdJdGVtLmxlbmd0aCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnZvbHVtZSA9IHBhcnNlRmxvYXQodGhpcy5lZGl0aW5nSXRlbS53aWR0aCkgKiBwYXJzZUZsb2F0KHRoaXMuZWRpdGluZ0l0ZW0ubGVuZ3RoKTsKICAgICAgICAgIHRoaXMuZmluZEFuZFNldEFkVm9sdW1lVHlwZSgpOwogICAgICAgICAgdGhpcy5jYWxjdWxhdGVBbmRTZXRNb250aGx5UGF5bWVudCgpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnZvbHVtZSA9IG51bGw7CiAgICAgICAgICB0aGlzLmNhbGN1bGF0ZUFuZFNldE1vbnRobHlQYXltZW50KCk7CiAgICAgICAgICB0aGlzLmZpbmRBbmRTZXRBZFZvbHVtZVR5cGUoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lZGl0aW5nSXRlbS52b2x1bWUgPSBudWxsOwogICAgICAgIHRoaXMuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgICAgICB0aGlzLmZpbmRBbmRTZXRBZFZvbHVtZVR5cGUoKTsKICAgICAgfQogICAgfSwKICAgIGFkZFBhc3Nwb3J0RGF0ZUNoYW5nZWQ6IGZ1bmN0aW9uIGFkZFBhc3Nwb3J0RGF0ZUNoYW5nZWQoZSkgewogICAgICBpZiAoZVswXSkgewogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0ucGFzc3BvcnRHaXZlbkRhdGUgPSBlWzBdOwogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0ucGFzc3BvcnRFeHBpcmVEYXRlID0gZVsxXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnBhc3Nwb3J0R2l2ZW5EYXRlID0gbnVsbDsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnBhc3Nwb3J0RXhwaXJlRGF0ZSA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBjdXN0b21MYWJlbEFkU2lkZTogZnVuY3Rpb24gY3VzdG9tTGFiZWxBZFNpZGUob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuYWRTaWRlcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEFkVm9sdW1lVHlwZTogZnVuY3Rpb24gY3VzdG9tTGFiZWxBZFZvbHVtZVR5cGUob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuYWRWb2x1bWVUeXBlcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEFkWm9uZTogZnVuY3Rpb24gY3VzdG9tTGFiZWxBZFpvbmUob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuYWRab25lcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEFkUmVnaW9uR3JvdXA6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsQWRSZWdpb25Hcm91cChvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5hZEdyb3Vwcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEFkVHlwZTogZnVuY3Rpb24gY3VzdG9tTGFiZWxBZFR5cGUob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuYWRUeXBlcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFN0cmVldDogZnVuY3Rpb24gY3VzdG9tTGFiZWxTdHJlZXQob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuc3RyZWV0cy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFF1YXJ0ZXI6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsUXVhcnRlcihvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5xdWFydGVycy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbERpc3RyaWN0OiBmdW5jdGlvbiBjdXN0b21MYWJlbERpc3RyaWN0KG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLmRpc3RyaWN0cy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICByZWdpb25TZWxlY3RlZDogZnVuY3Rpb24gcmVnaW9uU2VsZWN0ZWQoJGV2ZW50KSB7CiAgICAgIHZhciBfYXJndW1lbnRzID0gYXJndW1lbnRzLAogICAgICAgIF90aGlzOSA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciBkb250UmVzZXREaXN0cmljdDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgZG9udFJlc2V0RGlzdHJpY3QgPSBfYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICAgICAgICAgIGlmICghZG9udFJlc2V0RGlzdHJpY3QpIHsKICAgICAgICAgICAgICAgIF90aGlzOS5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLmRpc3RyaWN0SWQgPSBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gaGVscGVyU2VydmljZS5nZXRHZW9Mb2NhdGlvbnNCeVBhcmVudElkKCRldmVudCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBfdGhpczkuZGlzdHJpY3RzID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAoZG9udFJlc2V0RGlzdHJpY3QpIF90aGlzOS5kaXN0cmljdFNlbGVjdGVkKF90aGlzOS5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLmRpc3RyaWN0SWQsIHRydWUpOwogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZ2V0Q29lZmZpY2llbnRWYWx1ZTogZnVuY3Rpb24gZ2V0Q29lZmZpY2llbnRWYWx1ZShkaXN0cmljdElkLCBhZFpvbmVJZCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CiAgICAgIGlmIChkaXN0cmljdElkICYmIGFkWm9uZUlkICYmIHRoaXMuaXNCeUFnZW5jeSkgewogICAgICAgIGhlbHBlclNlcnZpY2UuZ2V0Q29lZmZpY2llbnRWYWx1ZUJ5Wm9uZUFuZERpc3RyaWN0SWRzKGRpc3RyaWN0SWQsIGFkWm9uZUlkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIF90aGlzMTAuY29lZmZpY2llbnRWYWx1ZSA9IHJlcy5kYXRhID8gcmVzLmRhdGEuY29lZmZpY2llbnQgOiBudWxsOwogICAgICAgICAgaWYgKF90aGlzMTAubWluQ29sbGVjdGlvblZhbHVlKSB7CiAgICAgICAgICAgIF90aGlzMTAuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgICAgICAgICAgLy8gdGhpcy4kc2V0KHRoaXMuZWRpdGluZ0l0ZW0sICdtb250aGx5UGF5bWVudCcsIHBhcnNlRmxvYXQodGhpcy5taW5Db2xsZWN0aW9uVmFsdWUpICogcGFyc2VGbG9hdCh0aGlzLmNvZWZmaWNpZW50VmFsdWUpKQogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIF90aGlzMTAuY29lZmZpY2llbnRWYWx1ZSA9IG51bGw7CiAgICAgICAgICAvLyB0aGlzLiRzZXQodGhpcy5lZGl0aW5nSXRlbSwgJ21vbnRobHlQYXltZW50JywgbnVsbCkKICAgICAgICAgIF90aGlzMTAuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGdldE1pbkNvbGxlY3Rpb25WYWx1ZTogZnVuY3Rpb24gZ2V0TWluQ29sbGVjdGlvblZhbHVlKHJlZ2lvbklkLCBkaXN0cmljdElkLCBhZExvY2F0aW9uVHlwZUlkLCBhZERlc2lnblR5cGVJZCwgYWRWb2x1bWVUeXBlSWQpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwogICAgICAvLyBHRVQgTUlOSU1VTV9DT0xMRUNUSU9OIChNKSBCWSBSRUdJT04sIERJU1RSSUNUIEFORCBBRF9ERVNJR05fVFlQRSBJRFMKICAgICAgaWYgKHJlZ2lvbklkICYmIGRpc3RyaWN0SWQgJiYgYWRMb2NhdGlvblR5cGVJZCAmJiBhZERlc2lnblR5cGVJZCAmJiB0aGlzLmlzQnlBZ2VuY3kgJiYgIXRoaXMuZWRpdGluZ0l0ZW0uaXNVekF2dG9ZdWwpIHsKICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldE1pbkNvbGxlY3Rpb25WYWx1ZUJ5UmVnaW9uQW5kRGlzdHJpY3RJZHMocmVnaW9uSWQsIGRpc3RyaWN0SWQsIGFkTG9jYXRpb25UeXBlSWQsIGFkRGVzaWduVHlwZUlkLCBhZFZvbHVtZVR5cGVJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBfdGhpczExLm1pbkNvbGxlY3Rpb25WYWx1ZSA9IHJlcy5kYXRhID8gcmVzLmRhdGEuY29zdCA6IG51bGw7CiAgICAgICAgICBpZiAoX3RoaXMxMS5jb2VmZmljaWVudFZhbHVlKSB7CiAgICAgICAgICAgIF90aGlzMTEuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgICAgICAgICAgLy8gdGhpcy4kc2V0KHRoaXMuZWRpdGluZ0l0ZW0sICdtb250aGx5UGF5bWVudCcsIHBhcnNlRmxvYXQodGhpcy5taW5Db2xsZWN0aW9uVmFsdWUpICogcGFyc2VGbG9hdCh0aGlzLmNvZWZmaWNpZW50VmFsdWUpKQogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIF90aGlzMTEubWluQ29sbGVjdGlvblZhbHVlID0gbnVsbDsKICAgICAgICAgIF90aGlzMTEuY2FsY3VsYXRlQW5kU2V0TW9udGhseVBheW1lbnQoKTsKICAgICAgICAgIC8vIHRoaXMuJHNldCh0aGlzLmVkaXRpbmdJdGVtLCAnbW9udGhseVBheW1lbnQnLCBudWxsKQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubWluQ29sbGVjdGlvblZhbHVlID0gbnVsbDsKICAgICAgfQogICAgfSwKICAgIGRpc3RyaWN0U2VsZWN0ZWQ6IGZ1bmN0aW9uIGRpc3RyaWN0U2VsZWN0ZWQoJGV2ZW50KSB7CiAgICAgIHZhciBfYXJndW1lbnRzMiA9IGFyZ3VtZW50cywKICAgICAgICBfdGhpczEyID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIGRvbnRSZXNldFF1YXJ0ZXI7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGRvbnRSZXNldFF1YXJ0ZXIgPSBfYXJndW1lbnRzMi5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMyWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzMlsxXSA6IGZhbHNlOwogICAgICAgICAgICAgIGlmICghZG9udFJlc2V0UXVhcnRlcikgewogICAgICAgICAgICAgICAgX3RoaXMxMi5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnF1YXJ0ZXJJZCA9IG51bGw7CiAgICAgICAgICAgICAgICBfdGhpczEyLmVkaXRpbmdJdGVtLmRpcmVjdG9yeUFkdmVydGlzZW1lbnRab25lSWQgPSBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0V2l0aEtleXdvcmQoJ2RpcmVjdG9yeS9xdWFydGVyLW5hbWVzJywgX3RoaXMxMi52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCwgImdldC1ieS1kaXN0cmljdElkLyIuY29uY2F0KCRldmVudCkpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgX3RoaXMxMi5xdWFydGVycyA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgX3RoaXMxMi5xdWFydGVycyA9IFtdOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA4OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX3RoaXMxMi5xdWFydGVycyA9IFtdOwogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBhZERlc2lnblR5cGVTZWxlY3RlZDogZnVuY3Rpb24gYWREZXNpZ25UeXBlU2VsZWN0ZWQoJGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzMTMuZ2V0TWluQ29sbGVjdGlvblZhbHVlKF90aGlzMTMuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5yZWdpb25JZCwgX3RoaXMxMy5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLmRpc3RyaWN0SWQsIF90aGlzMTMuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5QWR2ZXJ0aXNlbWVudExvY2F0aW9uVHlwZUlkLCAkZXZlbnQsIF90aGlzMTMuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5QWR2ZXJ0aXNlbWVudFZvbHVtZVR5cGVJZCk7CiAgICAgICAgICAgICAgX3RoaXMxMy5nZXRQcml2aWxlZ2VDb2VmZmljaWVudFZhbHVlQnlBZERlc2lnblR5cGVJZCgkZXZlbnQpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBhZFpvbmVTZWxlY3RlZDogZnVuY3Rpb24gYWRab25lU2VsZWN0ZWQoJGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzMTQuZ2V0Q29lZmZpY2llbnRWYWx1ZShfdGhpczE0LmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8uZGlzdHJpY3RJZCwgJGV2ZW50KTsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY3VzdG9tT2JqZWN0U3RhdGU6IGZ1bmN0aW9uIGN1c3RvbU9iamVjdFN0YXRlKG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLmFkT2JqZWN0U3RhdGVzLmZpbmQoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5pZCA9PSAob3B0LmlkID8gb3B0LmlkIDogb3B0KTsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy5nZXROYW1lKHsKICAgICAgICAgIG5hbWVSdTogc2VsZWN0ZWQubmFtZVJ1LAogICAgICAgICAgbmFtZUx0OiBzZWxlY3RlZC5uYW1lTHQsCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkLm5hbWVVegogICAgICAgIH0pKTsKICAgICAgfQogICAgICByZXR1cm4gIiI7CiAgICB9LAogICAgY3VzdG9tTGFiZWxDb250cmFjdG9yOiBmdW5jdGlvbiBjdXN0b21MYWJlbENvbnRyYWN0b3Iob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuY29udHJhY3RvcnMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoc2VsZWN0ZWQuZnVsbE5hbWUpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjb250cmFjdG9yUmVhY2hlZEVuZE9mTGlzdDogZnVuY3Rpb24gY29udHJhY3RvclJlYWNoZWRFbmRPZkxpc3QoZSkgewogICAgICBpZiAoZSkgewogICAgICAgIHRoaXMuZmV0Y2hDb250cmFjdG9ycygpOwogICAgICB9CiAgICB9LAogICAgY29udHJhY3RvclNlbGVjdGVkOiBmdW5jdGlvbiBjb250cmFjdG9yU2VsZWN0ZWQoY29udHJhY3RvckR0b09ySWQpIHsKICAgICAgdmFyIGRvbnRSZXNldElubiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBmcm9tSW5uU2VhcmNoID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgdmFyIGZvdW5kQ29udHJhY3RvciA9IGZyb21Jbm5TZWFyY2ggPyB0aGlzLmNvbnRyYWN0b3JzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5pZCA9PSBjb250cmFjdG9yRHRvT3JJZC5pZDsKICAgICAgfSkgOiB0aGlzLmNvbnRyYWN0b3JzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICByZXR1cm4gYy5pZCA9PSBjb250cmFjdG9yRHRvT3JJZDsKICAgICAgfSk7CiAgICAgIGlmIChmcm9tSW5uU2VhcmNoICYmIGNvbnRyYWN0b3JEdG9PcklkICYmICFmb3VuZENvbnRyYWN0b3IpIHsKICAgICAgICB0aGlzLmNvbnRyYWN0b3JzLnB1c2goY29udHJhY3RvckR0b09ySWQpOwogICAgICAgIGZvdW5kQ29udHJhY3RvciA9IGNvbnRyYWN0b3JEdG9PcklkOwogICAgICB9CiAgICAgIGlmIChmb3VuZENvbnRyYWN0b3IpIHsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmNvbnRyYWN0b3JJZCA9IGZyb21Jbm5TZWFyY2ggPyBjb250cmFjdG9yRHRvT3JJZC5pZCA6IGNvbnRyYWN0b3JEdG9PcklkOwogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0uaW5uID0gZm91bmRDb250cmFjdG9yLmlubjsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmNvbnRyYWN0b3JQaG9uZU51bWJlciA9IG51bGw7CiAgICAgICAgdGhpcy5lZGl0aW5nSXRlbS5jb250cmFjdG9yUGhvbmVOdW1iZXIgPSBmb3VuZENvbnRyYWN0b3IubW9iaWxlTnVtYmVyOwogICAgICAgIHRoaXMuJHNldCh0aGlzLmVkaXRpbmdJdGVtLCAnY29udHJhY3RvckFkZHJlc3MnLCAiIi5jb25jYXQoZm91bmRDb250cmFjdG9yLmFkZHJlc3NEdG8ucmVnaW9uTmFtZVV6LCAiLCAiKS5jb25jYXQoZm91bmRDb250cmFjdG9yLmFkZHJlc3NEdG8uZGlzdHJpY3ROYW1lVXosICIgIikuY29uY2F0KGZvdW5kQ29udHJhY3Rvci5hZGRyZXNzRHRvLmFkZGl0aW9uYWwgPyAnLCcgKyBmb3VuZENvbnRyYWN0b3IuYWRkcmVzc0R0by5hZGRpdGlvbmFsIDogJycpKTsKICAgICAgICAvLyB0aGlzLmVkaXRpbmdJdGVtLmNvbnRyYWN0b3JBZGRyZXNzID0gYCR7Zm91bmRDb250cmFjdG9yLmFkZHJlc3NEdG8ucmVnaW9uTmFtZVV6fSwgJHtmb3VuZENvbnRyYWN0b3IuYWRkcmVzc0R0by5kaXN0cmljdE5hbWVVen0gJHtmb3VuZENvbnRyYWN0b3IuYWRkcmVzc0R0by5hZGRpdGlvbmFsID8gJywnICsgZm91bmRDb250cmFjdG9yLmFkZHJlc3NEdG8uYWRkaXRpb25hbCA6ICcnfWAKICAgICAgICB0aGlzLmNvbnRyYWN0b3JOb3RGb3VuZCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghZG9udFJlc2V0SW5uKSB7CiAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmlubiA9IG51bGw7CiAgICAgICAgfQogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0uY29udHJhY3RvcklkID0gbnVsbDsKICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmNvbnRyYWN0b3JQaG9uZU51bWJlciA9IG51bGw7CiAgICAgICAgdGhpcy5lZGl0aW5nSXRlbS5jb250cmFjdG9yQWRkcmVzcyA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzOiBmdW5jdGlvbiBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzKHNlYXJjaFRleHQpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMxNS5kZWJvdW5jZSk7CiAgICAgICAgICAgICAgX3RoaXMxNS5kZWJvdW5jZSA9IHNldFRpbWVvdXQoIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczE1LmZldGNoQ29udHJhY3RvcnNXaXRoS2V5d29yZChzZWFyY2hUZXh0KTsKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgICAgICAgICAgfSkpLCAxMDAwKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvKiBhc3luYyBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzQnlJbm4gKHNlYXJjaFRleHQpIHsNCiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2UpOw0KICAgICAgICB0aGlzLmRlYm91bmNlID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7DQogICAgICAgICAgICBhd2FpdCB0aGlzLmdldFNpbmdsZUNvbnRyYWN0b3JCeUlubigpOw0KICAgICAgICB9LCAxMDAwKTsNCiAgICB9LCAqLwogICAgZmV0Y2hDb250cmFjdG9yc1dpdGhLZXl3b3JkOiBmdW5jdGlvbiBmZXRjaENvbnRyYWN0b3JzV2l0aEtleXdvcmQoa2V5d29yZCkgewogICAgICB2YXIgbWFrZVNlbGVjdGVkQnlJbm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICB2YXIgZnJvbUNvbnRyYWN0b3JNb2RhbENhbmNlbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHRoaXMuY29udHJhY3RvcnMgPSBbXTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlID0gMTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJzsKICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKG1ha2VTZWxlY3RlZEJ5SW5uLCBmcm9tQ29udHJhY3Rvck1vZGFsQ2FuY2VsKTsKICAgIH0sCiAgICBmZXRjaENvbnRyYWN0b3JzOiBmdW5jdGlvbiBmZXRjaENvbnRyYWN0b3JzKG1ha2VTZWxlY3RlZEJ5SW5uLCBmcm9tQ29udHJhY3Rvck1vZGFsQ2FuY2VsKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMxNi5pc0xvYWRpbmdDb250cmFjdG9ycyA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0V2l0aEtleXdvcmQoJ2NvbnRyYWN0b3InLCBfdGhpczE2LmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLCAnYnktY29udHJhY3RvcicpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgdmFyIF90aGlzMTYkY29udHJhY3RvcnM7CiAgICAgICAgICAgICAgICAoX3RoaXMxNiRjb250cmFjdG9ycyA9IF90aGlzMTYuY29udHJhY3RvcnMpLnB1c2guYXBwbHkoX3RoaXMxNiRjb250cmFjdG9ycywgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgIGlmIChtYWtlU2VsZWN0ZWRCeUlubiB8fCBmcm9tQ29udHJhY3Rvck1vZGFsQ2FuY2VsKSB7CiAgICAgICAgICAgICAgICAgIHZhciBmb3VuZENvbnRyYWN0b3IgPSBfdGhpczE2LmNvbnRyYWN0b3JzLmZpbmQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlubiA9PSBfdGhpczE2LmVkaXRpbmdJdGVtLmlubjsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGlmIChmb3VuZENvbnRyYWN0b3IpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE2LmNvbnRyYWN0b3JTZWxlY3RlZChmb3VuZENvbnRyYWN0b3IuaWQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfdGhpczE2Lmhhc05leHRQYWdlQ29udHJhY3RvcnMgPSByZXMuZGF0YS50b3RhbCAvIF90aGlzMTYuY29udHJhY3RvclNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gX3RoaXMxNi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlOwogICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlICs9IDE7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgX3RoaXMxNi5jb250cmFjdG9ycyA9IFtdOwogICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMxNi5pc0xvYWRpbmdDb250cmFjdG9ycyA9IGZhbHNlOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGFkTG9jYXRpb25UeXBlU2VsZWN0ZWQ6IGZ1bmN0aW9uIGFkTG9jYXRpb25UeXBlU2VsZWN0ZWQoYWRMb2NhdGlvblR5cGVPYmplY3RPcklkKSB7CiAgICAgIHZhciBfYXJndW1lbnRzMyA9IGFyZ3VtZW50cywKICAgICAgICBfdGhpczE3ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgIHZhciBkb250UmVzZXRBZERlc2lnblR5cGU7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBkb250UmVzZXRBZERlc2lnblR5cGUgPSBfYXJndW1lbnRzMy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHMzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzM1sxXSA6IGZhbHNlOwogICAgICAgICAgICAgIGlmICghZG9udFJlc2V0QWREZXNpZ25UeXBlKSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmRpcmVjdG9yeUFkdmVydGlzZW1lbnREZXNpZ25UeXBlSWQgPSBudWxsOwogICAgICAgICAgICAgICAgX3RoaXMxNy5lZGl0aW5nSXRlbS5kaXJlY3RvcnlBZHZlcnRpc2VtZW50Vm9sdW1lVHlwZUlkID0gbnVsbDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGFkTG9jYXRpb25UeXBlT2JqZWN0T3JJZCkgewogICAgICAgICAgICAgICAgX3RoaXMxNy5nZXRNaW5Db2xsZWN0aW9uVmFsdWUoX3RoaXMxNy5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnJlZ2lvbklkLCBfdGhpczE3LmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8uZGlzdHJpY3RJZCwgYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkID8gYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkIDogYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLCBfdGhpczE3LmVkaXRpbmdJdGVtLmRpcmVjdG9yeUFkdmVydGlzZW1lbnREZXNpZ25UeXBlSWQsIF90aGlzMTcuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5QWR2ZXJ0aXNlbWVudFZvbHVtZVR5cGVJZCk7CiAgICAgICAgICAgICAgICAvLyBHRVQgQURfVk9MVU1FX1RZUEVTCiAgICAgICAgICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldEFkVm9sdW1lVHlwZXNCeUFkTG9jYXRpb25UeXBlSWQoYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkID8gYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkIDogYWRMb2NhdGlvblR5cGVPYmplY3RPcklkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNy5hZFZvbHVtZVR5cGVzID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuZmluZEFuZFNldEFkVm9sdW1lVHlwZSgpOwogICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChfdGhpczE3LmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8ucmVnaW9uSWQpIHsKICAgICAgICAgICAgICAgICAgLy8gR0VUIEFEX0RFU0lHTl9UWVBFUwogICAgICAgICAgICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldEFkRGVzaWduVHlwZXNCeUFkTG9jYXRpb25UeXBlSWQoYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkID8gYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLmlkIDogYWRMb2NhdGlvblR5cGVPYmplY3RPcklkLCBfdGhpczE3LmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8ucmVnaW9uSWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTcuYWREZXNpZ25UeXBlcyA9IHJlcy5kYXRhOwogICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTcuYWREZXNpZ25UeXBlcyA9IFtdOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuYWREZXNpZ25UeXBlcyA9IFtdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LmFkRGVzaWduVHlwZXMgPSBbXTsKICAgICAgICAgICAgICAgIF90aGlzMTcuYWRWb2x1bWVUeXBlcyA9IFtdOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjdXN0b21MYWJlbEFkTG9jYXRpb25UeXBlOiBmdW5jdGlvbiBjdXN0b21MYWJlbEFkTG9jYXRpb25UeXBlKG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLmFkTG9jYXRpb25UeXBlcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gKG9wdC5pZCA/IG9wdC5pZCA6IG9wdCk7CiAgICAgIH0pOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMuZ2V0TmFtZSh7CiAgICAgICAgICBuYW1lUnU6IHNlbGVjdGVkLm5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWQubmFtZUx0LAogICAgICAgICAgbmFtZVV6OiBzZWxlY3RlZC5uYW1lVXoKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIGN1c3RvbUxhYmVsQWREZXNpZ25UeXBlOiBmdW5jdGlvbiBjdXN0b21MYWJlbEFkRGVzaWduVHlwZShvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5hZERlc2lnblR5cGVzLmZpbmQoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5pZCA9PSAob3B0LmlkID8gb3B0LmlkIDogb3B0KTsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQodGhpcy5nZXROYW1lKHsKICAgICAgICAgIG5hbWVSdTogc2VsZWN0ZWQubmFtZVJ1LAogICAgICAgICAgbmFtZUx0OiBzZWxlY3RlZC5uYW1lTHQsCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkLm5hbWVVegogICAgICAgIH0pKTsKICAgICAgfQogICAgICByZXR1cm4gIiI7CiAgICB9LAogICAgY3VzdG9tTGFiZWxSZWdpb246IGZ1bmN0aW9uIGN1c3RvbUxhYmVsUmVnaW9uKG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLnJlZ2lvbnMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLnJlZ2lvbklkID09IChvcHQucmVnaW9uSWQgPyBvcHQucmVnaW9uSWQgOiBvcHQpOwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5yZWdpb25OYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLnJlZ2lvbk5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQucmVnaW9uTmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFVuaXQ6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsVW5pdChvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy51bml0cy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gKG9wdC5pZCA/IG9wdC5pZCA6IG9wdCk7CiAgICAgIH0pOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMuZ2V0TmFtZSh7CiAgICAgICAgICBuYW1lUnU6IHNlbGVjdGVkLm5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWQubmFtZUx0LAogICAgICAgICAgbmFtZVV6OiBzZWxlY3RlZC5uYW1lVXoKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIHRyZWVDbG9zZWQ6IGZ1bmN0aW9uIHRyZWVDbG9zZWQodmVlTmFtZSkgewogICAgICB0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIucmVmc1t2ZWVOYW1lXS52YWxpZGF0ZSgpOwogICAgfSwKICAgIG5vcm1hbGl6ZXI6IGZ1bmN0aW9uIG5vcm1hbGl6ZXIobm9kZSkgewogICAgICBpZiAoIW5vZGUuY2hpbGRyZW4gfHwgbm9kZS5jaGlsZHJlbi5sZW5ndGggPT09IDApIHsKICAgICAgICBkZWxldGUgbm9kZS5jaGlsZHJlbjsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaWQ6IG5vZGUuaWQsCiAgICAgICAgICBsYWJlbDogdGhpcy5nZXROYW1lKHsKICAgICAgICAgICAgbmFtZVJ1OiBub2RlLm5hbWVSdSwKICAgICAgICAgICAgbmFtZUx0OiBub2RlLm5hbWVMdCwKICAgICAgICAgICAgbmFtZVV6OiBub2RlLm5hbWVVegogICAgICAgICAgfSkKICAgICAgICB9OwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgaWQ6IG5vZGUuaWQsCiAgICAgICAgbGFiZWw6IHRoaXMuZ2V0TmFtZSh7CiAgICAgICAgICBuYW1lUnU6IG5vZGUubmFtZVJ1LAogICAgICAgICAgbmFtZUx0OiBub2RlLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogbm9kZS5uYW1lVXoKICAgICAgICB9KSwKICAgICAgICBjaGlsZHJlbjogbm9kZS5jaGlsZHJlbiAmJiBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDAgPyBub2RlLmNoaWxkcmVuIDogW10KICAgICAgfTsKICAgIH0sCiAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CiAgICAgIHRoaXMuY29tcHV0ZWRPYnNlcnZlci52YWxpZGF0ZSgpLnRoZW4oZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAoX3RoaXMxOC5lZGl0aW5nSXRlbS5pZCB8fCBfdGhpczE4LiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS51cGRhdGUoTUFJTl9BUElfVVJMLCBfdGhpczE4LmVkaXRpbmdJdGVtLCBmYWxzZSwgdHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXMxOC5jb21wdXRlZE9ic2VydmVyLnJlc2V0KCk7CiAgICAgICAgICAgICAgX3RoaXMxOC5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHsKICAgICAgICAgICAgICAgIGFkZHJlc3NEdG86IHt9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX3RoaXMxOC4kcm91dGVyLmdvKC0xKTsKICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdChfdGhpczE4LiR0KCdtZXNzYWdlcy5zYXZlZF9zdWNjZXNzZnVsbHknKSwgewogICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5jcmVhdGUoTUFJTl9BUElfVVJMLCBfdGhpczE4LmVkaXRpbmdJdGVtLCBmYWxzZSwgdHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXMxOC5jb21wdXRlZE9ic2VydmVyLnJlc2V0KCk7CiAgICAgICAgICAgICAgX3RoaXMxOC5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHsKICAgICAgICAgICAgICAgIGFkZHJlc3NEdG86IHt9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX3RoaXMxOC4kcm91dGVyLmdvKC0xKTsKICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdChfdGhpczE4LiR0KCdtZXNzYWdlcy5zYXZlZF9zdWNjZXNzZnVsbHknKSwgewogICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczE4LiR0b2FzdChfdGhpczE4LiR0KCdtZXNzYWdlcy5maWxsX3JlcXVpcmVkX2ZpZWxkcycpLCB7CiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICAvKg0KICAqIENSRUFURUQgKi8KICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMTkgPSB0aGlzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF90aGlzMTkudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQuaXRlbXNQZXJQYWdlID0gNTAwOwogICAgICAgICAgICBfdGhpczE5LmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMxOS52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCk7CiAgICAgICAgICAgIGlmICghX3RoaXMxOS5pc01vZGVDcmVhdGUpIHsKICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDU7CiAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEVtcHR5KE1BSU5fQVBJX1VSTCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXMxOS5lZGl0aW5nSXRlbSA9IHJlcy5kYXRhOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gOTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDk7CiAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEJ5SWQoTUFJTl9BUElfVVJMLCBfdGhpczE5LiRyb3V0ZS5wYXJhbXMuaWQsIHRydWUsIG51bGwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzMTkuZWRpdGluZ0l0ZW0gPSByZXMuZGF0YTsKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDExOwogICAgICAgICAgICByZXR1cm4gaGVscGVyU2VydmljZS5mZXRjaFJlZ2lvbnNGb3JQZXRyb2xCeUN1cnJlbnRVc2VySWQoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczE5LnJlZ2lvbnMgPSByZXMuZGF0YTsKICAgICAgICAgICAgICBfdGhpczE5LnJlZ2lvblNlbGVjdGVkKF90aGlzMTkuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0byA/IF90aGlzMTkuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5yZWdpb25JZCA6IG51bGwsIHRydWUpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDEzOwogICAgICAgICAgICByZXR1cm4gX3RoaXMxOS5mZXRjaENvbnRyYWN0b3JzKCk7CiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBpZiAoIV90aGlzMTkuaXNNb2RlQ3JlYXRlKSB7CiAgICAgICAgICAgICAgX3RoaXMxOS5jb250cmFjdG9yU2VsZWN0ZWQoX3RoaXMxOS5lZGl0aW5nSXRlbS5jb250cmFjdG9ySWQpOwogICAgICAgICAgICB9CiAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEzKTsKICAgIH0pKSgpOwogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;AAiVA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;EACAA;EACA;AACA;EACAC;IACAC;IACAC;EAEA;EACA;AACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACA;AACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACA;AACA;EACAC;IACAC;MAAA;MACA;MAEA;QACA;UACA;YACA;UACA;QACA;MACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MACA;QACAC,2EACAC;UACA;UACA;QACA,GACAC;UAAA;QAAA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA,KACA;gBAAA;gBAAA;cAAA;cAAA;cAAA,OACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAEA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAC;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;MAAA;MACA;AACA;MACA;MACA;MACAP,+FACAC;QACA;QACA;UACA;YAAAO;UAAA;QACA;MACA,GACAN;QACAO;MACA,GACAC;QACA;QACA;AACA;QACA;UACA,wEACA,QACA;UACAC;YACAC;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;QACAC;MAEA;QACAA;MACA;MAEA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;cAAA;cAAA,OACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACAC;MAEA;IACA;IACAC;MAAA;MACApB,uDACAC;QACA;UACA;YAAAoB;UAAA;UACA;QACA;MACA,GACAnB;QACAO;MACA;IACA;IACAa;MAAA;MACA;QACAtB,uDACAC;UACA;YACAD,+DACAC;cACA;cACA;YACA,GACAC;cACA;YACA;UACA;YACA;cAAAmB;YAAA;YACA;UACA;QACA,GACAnB;UACAO;QACA;MACA;IACA;IACAc;MACA;QACA;UACA;UACA;UACA;QACA;UACA;UACA;UACA;QACA;MACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACAC;UACAC;UACAC;QACA;MACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACAH;UACAC;UACAC;QACA;MACA;MACA;IACA;IACAE;MACA;QAAA;MAAA;MACA;QACA;UACAJ;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAG;MACA;QAAA;MAAA;MACA;QACA;UACAL;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAI;MACA;QAAA;MAAA;MACA;QACA;UACAN;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAK;MACA;QAAA;MAAA;MACA;QACA;UACAP;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAM;MACA;QAAA;MAAA;MACA;QACA;UACAR;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAO;MACA;QAAA;MAAA;MACA;QACA;UACAT;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAQ;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAC;cACA;gBACA;cACA;cAAA,KACAC;gBAAA;gBAAA;cAAA;cAAA;cAAA,OAEAtC,gDACAC;gBACA;gBACA,uBACA;cACA,GACAC;gBACAO;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAEA;IACA8B;MAAA;MACA;QACAvC,4EACAC;UACA;UACA;YACA;YACA;UACA;QACA,GACAC;UACAO;UACA;UACA;UACA;QACA;MACA;IACA;IACA+B;MAAA;MACA;MACA;QACAxC,kIACAC;UACA;UACA;YACA;YACA;UACA;QACA,GACAC;UACAO;UACA;UACA;UACA;QACA;MACA;QACA;MACA;IACA;IACAgC;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAC;cACA;gBACA;gBACA;cACA;cAAA,KACAJ;gBAAA;gBAAA;cAAA;cAAA;cAAA,OAEAK,8IACA1C;gBACA;cACA,GACAC;gBACAO;gBACA;cACA;YAAA;cAAA;cAAA;YAAA;cAEA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAEA;IACAmC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACApB;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAmB;MACA;QAAA;MAAA;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;MACA;QAAA;MAAA;QAAA;MAAA;MACA;QACA;QACAC;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;QACA;UACA;QACA;QACA;QACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA7C;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACA8C;MAAA;MAAA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACAV,0GACA1C;gBAAA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;gBACA;gBACA;cACA,GACAC;gBACAO;gBACA;cACA,GACAC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA4C;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAC;cACA;gBACA;gBACA;cACA;cACA;gBACA;gBACA;gBACAvD,cACAwD,yHACAvD;kBACA;kBACA;gBACA,GACAC;kBACAO;gBACA;gBACA;kBACA;kBACAT,cACAyD,kKACAxD;oBACA;kBACA,GACAC;oBACAO;oBACA;kBACA;gBACA;kBACA;gBACA;cACA;gBACA;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAiD;MACA;QAAA;MAAA;MACA;QACA;UACAhC;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACA+B;MACA;QAAA;MAAA;MACA;QACA;UACAjC;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAgC;MACA;QAAA;MAAA;MACA;QACA;UACAlC;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAiC;MACA;QAAA;MAAA;MACA;QACA;UACAnC;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAkC;MACA;IACA;IACAC;MACA;QACA;QACA;UACAC;UACAC;YACAvC;YACAC;YACAC;UACA;QACA;MACA;MACA;QACAoC;QACAC;UACAvC;UACAC;UACAC;QACA;QACAsC;MACA;IACA;IACAC;MAAA;MACA;QACA;UACA;YACAxB;cACA;cACA;gBAAAlG;cAAA;cACA;cACA;gBAAA2H;cAAA;YACA;UACA;YACAzB;cACA;cACA;gBAAAlG;cAAA;cACA;cACA;gBAAA2H;cAAA;YACA;UACA;QACA;UACA;YAAAA;UAAA;QACA;MACA;IACA;EACA;EACA;AACA;EACAC;IAAA;IAAA;MAAA;QAAA;UAAA;YACA;YACA;YAAA,KACA;cAAA;cAAA;YAAA;YAAA;YAAA,OACA1B,2CACA1C;cACA;YACA,GACAC;cACAO;YACA;UAAA;YAAA;YAAA;UAAA;YAAA;YAAA,OAEAkC,gFACA1C;cACA;YACA,GACAC;cACAO;YACA;UAAA;YAAA;YAAA,OAIAT,qDACAC;cACA;cACA;YACA,GACAC;cACAO;YACA;UAAA;YAAA;YAAA,OAGA;UAAA;YACA;cACA;YACA;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EACA;AACA","names":["name","components","MapInModal","CreateFormContractor","data","notFormattedMonthlyPayment","adSideValue","districtModal","quartersModal","streetsModal","mapModal","editingItem","addressDto","hasNextPageContractors","contractors","debounce","isLoadingContractors","districts","quarters","streets","adTypes","adGroups","adZones","adSides","adVolumeTypes","localPassportExpireDate","contractorCreateModal","minCollectionValue","coefficientValue","contractorNotFound","contractorSearchPayload","checkPassportNumberLoading","dbPassportNumber","isPassportNumberInvalid","minimumCollections","createMultipleMinimumCollectionsModal","singleMinimumCollectionUpdateModal","statuses","regions","units","adLocationTypes","adDesignTypes","adObjectStates","dropzoneOptions","url","dictDefaultMessage","thumbnailWidth","maxFilesize","addRemoveLinks","dictRemoveFile","maxFiles","architectDocFile","photo","passportDocFile","passportPhoto","paymentDocFile","computed","inputMinValue","inputMaxValue","isModeCreate","computedObserver","methods","findAndSetAdVolumeType","adSideSelected","adVolumeTypeSelected","calculateAndSetMonthlyPayment","getPrivilegeCoefficientValueByAdDesignTypeId","helperService","then","catch","newRefCreated","onBlurPassportNumberInput","debounceCheckPassportNumber","clearTimeout","checkAdPassportNumber","PassportNumber","console","finally","setTimeout","passportNumberInput","saveLocation","drawCreated","layer","openMapModal","contractorSaved","createContractor","e","validateInn","INN","getSingleContractorByInn","handleWidthLengthInput","addPassportDateChanged","customLabelAdSide","nameRu","nameLt","nameUz","customLabelAdVolumeType","customLabelAdZone","customLabelAdRegionGroup","customLabelAdType","customLabelStreet","customLabelQuarter","customLabelDistrict","regionSelected","dontResetDistrict","$event","getCoefficientValue","getMinCollectionValue","districtSelected","dontResetQuarter","crudAndListsService","adDesignTypeSelected","adZoneSelected","customObjectState","customLabelContractor","contractorReachedEndOfList","contractorSelected","foundContractor","debounceSearchContractors","fetchContractorsWithKeyword","fetchContractors","adLocationTypeSelected","dontResetAdDesignType","getAdVolumeTypesByAdLocationTypeId","getAdDesignTypesByAdLocationTypeId","customLabelAdLocationType","customLabelAdDesignType","customLabelRegion","customLabelUnit","treeClosed","normalizer","id","label","children","save","type","created"],"sourceRoot":"src/modules/products/petrol-stations/modules/list_and_crud","sources":["CreateOrUpdate.vue"],"sourcesContent":["<template>\r\n    <base-create-or-update-wrapper\r\n        @save=\"save\"\r\n        has-save-suspend\r\n        :custom-title=\"$t('submodules.ad_passport_info.title') + ' - ' + isModeCreate ? $t('actions.create') : $t('actions.update')\"\r\n    >\r\n        <ValidationObserver\r\n            ref=\"observer\"\r\n            v-slot=\"{}\"\r\n        >\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        :rules=\"{required: true, regex: /\\b\\d{9}\\b/}\"\r\n                        class=\"required\"\r\n                        name=\"INN\"\r\n                        v-model=\"editingItem.inn\"\r\n                        @blur=\"validateInn\"\r\n                        @keyup.enter=\"getSingleContractorByInn\"\r\n                        mask=\"#########\"\r\n                        :label=\"$t('column.petrol_station_owner_inn')\"\r\n                        with-input-append\r\n                    >\r\n                        <template v-slot:append-slot>\r\n                            <!-- CONTRACTOR SEARCH BUTTON -->\r\n                            <b-button\r\n                                v-if=\"!contractorNotFound\"\r\n                                @click=\"getSingleContractorByInn\"\r\n                                variant=\"outline-primary\"\r\n                                id=\"contractorSearchButton\"\r\n                                style=\"padding: 2.5px 10px; font-size: 1.2rem;\"\r\n                            >\r\n                                <i class=\"mdi mdi-account-search\"/>\r\n                            </b-button>\r\n                            <!-- CONTRACTOR ADD BUTTON -->\r\n                            <b-button\r\n                                v-else\r\n                                @click=\"contractorCreateModal = true\"\r\n                                variant=\"outline-info\"\r\n                                id=\"contractorSearchButton\"\r\n                                style=\"padding: 2.5px 10px; font-size: 1.2rem;\"\r\n                            >\r\n                                <i class=\"mdi mdi-plus-circle\"/>\r\n                            </b-button>\r\n                        </template>\r\n                    </BaseInputWithValidation>\r\n                </b-col>\r\n\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.contractorId\"\r\n                        :has-next-page=\"hasNextPageContractors\"\r\n                        @select=\"contractorSelected\"\r\n                        @reachedEndOfList=\"contractorReachedEndOfList\"\r\n                        @search-change=\"debounceSearchContractors\"\r\n                        :searchable=\"true\"\r\n                        :allow-empty=\"false\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingContractors\"\r\n                        :internal-search=\"false\"\r\n                        :options=\"contractors.map(e => e.id)\"\r\n                        :label=\"$t('column.petrol_station_owner')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelContractor\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        not-required\r\n                        disabled\r\n                        v-model=\"editingItem.contractorPhoneNumber\"\r\n                        :label=\"$t('column.petrol_station_owner_phone_number')\"\r\n                        mask=\"+998#########\"\r\n                    />\r\n                </b-col>\r\n\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseTextareaWithValidation\r\n                        not-required\r\n                        disabled\r\n                        v-model=\"editingItem.contractorAddress\"\r\n                        max-rows=\"2\"\r\n                        :label=\"$t('column.petrol_station_owner_address')\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col cols=\"12\">\r\n                    <h5 class=\"m-0 text-center\">\r\n                        {{ $t('column.petrol_station_exact_address') }}\r\n                    </h5>\r\n                    <hr>\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.addressDto.regionId\"\r\n                        @select=\"regionSelected\"\r\n                        :options=\"regions.map(e => e.regionId)\"\r\n                        :label=\"$t('column.region')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelRegion\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.addressDto.districtId\"\r\n                        @select=\"districtSelected\"\r\n                        :options=\"districts.map(e => e.id)\"\r\n                        :label=\"$t('column.district')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelDistrict\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.addressDto.quarterId\"\r\n                        :options=\"quarters.map(e => e.id)\"\r\n                        :label=\"$t('column.quarter')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelQuarter\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        withCreateAddition\r\n                    >\r\n                        <template v-slot:append-slot>\r\n                            <b-button\r\n                                @click=\"quartersModal = true\"\r\n                                variant=\"outline-primary\"\r\n                                style=\"padding: 2.5px 10px; font-size: 1.2rem;\"\r\n                            >\r\n                                <i class=\"mdi mdi-plus-circle\"/>\r\n                            </b-button>\r\n                        </template>\r\n                    </BaseMultiselectWithValidation>\r\n                    <BaseModalForCreate\r\n                        v-model=\"quartersModal\"\r\n                        mainApiUrl=\"directory/quarter-names\"\r\n                        :additional-params=\"{regionId: editingItem.addressDto.regionId,\r\n              districtId: editingItem.addressDto.districtId}\"\r\n                        createFormName=\"CreateFormGeoRegionQuarters\"\r\n                        @new-ref-created=\"newRefCreated\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <b-row>\r\n                        <b-col cols=\"6\">\r\n                            <BaseInputWithValidation\r\n                                rules=\"required|positiveNotZero\"\r\n                                class=\"required\"\r\n                                :disabled=\"true\"\r\n                                v-model=\"editingItem.latNumber\"\r\n                                custom-styles=\"grid-template-columns: 51% 43%;\"\r\n                                name=\"addressLocation\"\r\n                                :label=\"$t('column.location_address')\"\r\n                                :placeholder=\"$t('column.latitude')\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col cols=\"3\">\r\n                            <BaseInputWithValidation\r\n                                rules=\"required|positiveNotZero\"\r\n                                only-form-element\r\n                                v-model=\"editingItem.lngNumber\"\r\n                                :disabled=\"true\"\r\n                                custom-styles=\"grid-template-columns: unset;\"\r\n                                :placeholder=\"$t('column.longitude')\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col cols=\"3\">\r\n                            <b-button\r\n                                @click=\"openMapModal\"\r\n                                variant=\"primary\"\r\n                                size=\"sm\"\r\n                                pill\r\n                            >\r\n                                <i class=\"mdi mdi-map-marker font-size-16 align-middle\"/>\r\n                                {{ $t('column.map') }}\r\n                            </b-button>\r\n                        </b-col>\r\n                    </b-row>\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.addressDto.additional\"\r\n                        name=\"additionalAddress\"\r\n                        :label=\"$t('column.orienter')\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col cols=\"12\">\r\n                    <hr>\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.name\"\r\n                        :label=\"$t('column.name')\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseTextareaWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.description\"\r\n                        max-rows=\"8\"\r\n                        :label=\"$t('column.comment')\"\r\n                        :placeholder=\"$t('column.comment')\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseDatePickerWithValidation\r\n                        required\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        disableAfter\r\n                        v-model=\"editingItem.constructDate\"\r\n                        :label=\"$t('column.created_date')\"\r\n                        lang=\"ru\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        v-if=\"!isModeCreate\"\r\n                        disabled\r\n                        :label=\"$t('column.created_by')\"\r\n                        v-model=\"editingItem.createdByEmployeeFullName\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n        </ValidationObserver>\r\n\r\n        <!-- CONTRACTOR CREATE MODAL -->\r\n        <b-modal\r\n            v-model=\"contractorCreateModal\"\r\n            id=\"create-multiple-min-collections-modal-id\"\r\n            size=\"xl\"\r\n            :title=\"$t('column.contractor')\"\r\n            title-class=\"font-18\"\r\n            :ok-title=\"$t('actions.save')\"\r\n            @ok=\"createContractor\"\r\n            @cancel=\"fetchContractorsWithKeyword('', false, true)\"\r\n            ok-variant=\"success\"\r\n            :cancel-title=\"$t('actions.cancel')\"\r\n            cancel-variant=\"danger\"\r\n            no-close-on-backdrop\r\n            no-close-on-esc\r\n        >\r\n            <CreateFormContractor\r\n                @saved=\"contractorSaved\"\r\n                :custom-is-mode-create=\"true\"\r\n                ref=\"createFormContractor\"\r\n            />\r\n        </b-modal>\r\n\r\n        <!-- MAP TO CHOOSE LOCATION OF AD_CONSTRUCTION -->\r\n        <MapInModal\r\n            :visible=\"mapModal\"\r\n            :event=\"{lat: editingItem.latNumber, lng: editingItem.lngNumber}\"\r\n            @saveLocation=\"saveLocation\"\r\n            @close=\"mapModal = false\"\r\n        />\r\n    </base-create-or-update-wrapper>\r\n</template>\r\n<script>\r\nconst MAIN_API_URL = 'petrol'\r\nconst APPEND_API_URL_FOR_GOVERNMENT = 'by-first-agent'\r\n/*\r\n* YOU MUST SEND {{ MAIN_API_URL }} TO CRUD_SERVICE */\r\nimport crudAndListsService from \"@/shared/services/crud_and_list.service\"\r\nimport helperService from \"@/shared/services/helper.service\"\r\n\r\nimport MapInModal from './components/MapInModal'\r\nimport CreateFormContractor from '@/shared/views/components/CreateFormContractor'\r\n\r\nexport default {\r\n    name: \"CreateOrUpdate\",\r\n    /*\r\n    * COMPONENTS */\r\n    components: {\r\n        MapInModal,\r\n        CreateFormContractor\r\n\r\n    },\r\n    /*\r\n    * DATA */\r\n    data () {\r\n        return {\r\n            notFormattedMonthlyPayment: null,\r\n            adSideValue: null,\r\n            districtModal: false,\r\n            quartersModal: false,\r\n            streetsModal: false,\r\n            mapModal: false,\r\n\r\n            editingItem: {\r\n                addressDto: {}\r\n            },\r\n            hasNextPageContractors: false,\r\n            contractors: [],\r\n            debounce: null,\r\n            isLoadingContractors: false,\r\n            districts: [],\r\n            quarters: [],\r\n            streets: [],\r\n            adTypes: [],\r\n            adGroups: [],\r\n            adZones: [],\r\n            adSides: [],\r\n            adVolumeTypes: [],\r\n            localPassportExpireDate: [],\r\n            contractorCreateModal: false,\r\n            minCollectionValue: null,\r\n            coefficientValue: null,\r\n            contractorNotFound: false,\r\n            contractorSearchPayload: {},\r\n            checkPassportNumberLoading: false,\r\n            dbPassportNumber: '',\r\n            isPassportNumberInvalid: false,\r\n\r\n            minimumCollections: [],\r\n            createMultipleMinimumCollectionsModal: false,\r\n            singleMinimumCollectionUpdateModal: false,\r\n            statuses: [],\r\n            regions: [],\r\n            units: [],\r\n            adLocationTypes: [],\r\n            adDesignTypes: [],\r\n            adObjectStates: [],\r\n            dropzoneOptions: {\r\n                url: \"https://httpbin.org/post\",\r\n                dictDefaultMessage: '.',\r\n                thumbnailWidth: 150,\r\n                maxFilesize: 1.0,\r\n                addRemoveLinks: true,\r\n                dictRemoveFile: 'x',\r\n                maxFiles: 3,\r\n            },\r\n            architectDocFile: {},\r\n            photo: {},\r\n            passportDocFile: {},\r\n            passportPhoto: {},\r\n            paymentDocFile: {},\r\n        }\r\n    },\r\n    /*\r\n    * COMPUTED */\r\n    computed: {\r\n        inputMinValue (value) {\r\n            return value.editingItem.passportGivenDate\r\n        },\r\n        inputMaxValue (value) {\r\n            return value.editingItem.passportExpireDate\r\n        },\r\n        isModeCreate () {\r\n            return this.$route.name == 'CreatePetrolStation'\r\n        },\r\n        computedObserver () {\r\n            return this.$refs.observer\r\n        }\r\n    },\r\n    /*\r\n    * METHODS */\r\n    methods: {\r\n        findAndSetAdVolumeType () {\r\n            this.editingItem.directoryAdvertisementVolumeTypeId = null\r\n\r\n            if (this.editingItem.volume) {\r\n                this.adVolumeTypes.forEach(vType => {\r\n                    if (parseFloat(this.editingItem.volume) >= vType.minBorder && parseFloat(this.editingItem.volume) <= vType.maxBorder) {\r\n                        this.editingItem.directoryAdvertisementVolumeTypeId = vType.id\r\n                    }\r\n                })\r\n            }\r\n            this.adVolumeTypeSelected(this.editingItem.directoryAdvertisementVolumeTypeId)\r\n        },\r\n        adSideSelected ($event) {\r\n            let foundAdSide = this.adSides.find(el => el.id == $event)\r\n            this.adSideValue = foundAdSide ? foundAdSide.code : null\r\n            this.calculateAndSetMonthlyPayment()\r\n        },\r\n        adVolumeTypeSelected ($event) {\r\n            this.getMinCollectionValue(this.editingItem.addressDto.regionId, this.editingItem.addressDto.districtId, this.editingItem.directoryAdvertisementLocationTypeId, this.editingItem.directoryAdvertisementDesignTypeId, $event)\r\n        },\r\n        calculateAndSetMonthlyPayment () {\r\n            this.$set(this.editingItem, 'monthlyPayment', null)\r\n            this.notFormattedMonthlyPayment = null\r\n            if (this.minCollectionValue && this.coefficientValue && this.editingItem.designTypePrivilegeCoefficient && this.editingItem.volume && this.adSideValue) {\r\n                let num = (parseFloat(this.minCollectionValue) * parseFloat(this.coefficientValue) * parseFloat(this.editingItem.designTypePrivilegeCoefficient) * parseFloat(this.editingItem.volume) * parseFloat(this.adSideValue)).toFixed(2)\r\n                this.notFormattedMonthlyPayment = num\r\n                let formattedPaymentValue = this.getNumberFormat(num)\r\n                this.$set(this.editingItem, 'monthlyPayment', formattedPaymentValue)\r\n            } else {\r\n                this.$set(this.editingItem, 'monthlyPayment', null)\r\n                this.notFormattedMonthlyPayment = null\r\n            }\r\n        },\r\n        getPrivilegeCoefficientValueByAdDesignTypeId (adDesignTypeId) {\r\n            if (adDesignTypeId) {\r\n                helperService.getPrivilegeCoefficientValueByAdDesignTypeId(adDesignTypeId)\r\n                    .then(res => {\r\n                        this.editingItem.designTypePrivilegeCoefficient = res.data\r\n                        this.calculateAndSetMonthlyPayment()\r\n                    })\r\n                    .catch(e => console.log(e))\r\n            }\r\n        },\r\n        newRefCreated (newOptions, newId, formName) {\r\n            if (formName == 'CreateFormGeoRegionQuarters') {\r\n                this.quarters = newOptions\r\n                this.editingItem.addressDto.quarterId = newId\r\n            } else if (formName == 'CreateFormGeoRegionStreets') {\r\n                this.streets = newOptions\r\n                this.editingItem.addressDto.streetId = newId\r\n            }\r\n        },\r\n        async onBlurPassportNumberInput (value) {\r\n            if (this.isPassportNumberInvalid) {\r\n                await this.checkAdPassportNumber(value, true);\r\n            }\r\n        },\r\n        async debounceCheckPassportNumber (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.checkAdPassportNumber(searchText);\r\n            }, 1000);\r\n        },\r\n        checkAdPassportNumber (searchQuery = \"\", fromOnBlur = false) {\r\n            /*\r\n             * AVOID MULTIPLE REQUESTS AT ONCE */\r\n            if (!this.editingItem.addressDto.regionId || !searchQuery || this.checkPassportNumberLoading || (!this.isModeCreate && this.editingItem.passportNumber == this.dbPassportNumber)) return;\r\n            this.checkPassportNumberLoading = true;\r\n            helperService.checkAdPassportNumberByRegion(searchQuery, this.editingItem.addressDto.regionId)\r\n                .then(res => {\r\n                    this.isPassportNumberInvalid = res.data;\r\n                    if (this.isPassportNumberInvalid) {\r\n                        this.computedObserver.setErrors({ PassportNumber: [this.$t('validator.ad_passport_number_already_in_use')] });\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n                .finally(() => {\r\n                    this.checkPassportNumberLoading = false;\r\n                    /*\r\n                       * FOYDALANUVCHI YOZAYOTGAN BO'LSA INPUTNI QAYTA FOCUS QIL (ON_BLUR EVENTDAN BO'LSA FOCUS QILMA) */\r\n                    if (!fromOnBlur) {\r\n                        let passportNumberInput = this.$refs.passportNumber.$el.querySelector(\r\n                            \"input\"\r\n                        );\r\n                        setTimeout(() => {\r\n                            passportNumberInput.focus();\r\n                        }, 50);\r\n                    }\r\n                });\r\n        },\r\n        saveLocation (e) {\r\n            this.$set(this.editingItem, 'latNumber', e.lat)\r\n            this.$set(this.editingItem, 'lngNumber', e.lng)\r\n            this.mapModal = false\r\n        },\r\n        drawCreated (e) {\r\n            var type = e.layerType,\r\n                layer = e.layer;\r\n\r\n            if (type === 'marker') {\r\n                layer.bindPopup('A popup!');\r\n            }\r\n\r\n            this.featureGroup.addLayer(layer);\r\n        },\r\n        openMapModal () {\r\n            this.mapModal = true\r\n        },\r\n        async contractorSaved (res) {\r\n            this.contractorCreateModal = false\r\n            this.contractorNotFound = false\r\n            await this.fetchContractorsWithKeyword('', true)\r\n        },\r\n        createContractor (e) {\r\n            e.preventDefault()\r\n\r\n            this.$refs.createFormContractor.save()\r\n        },\r\n        validateInn () {\r\n            helperService.validateInnFromApi(this.editingItem.inn)\r\n                .then(res => {\r\n                    if (!res.data) {\r\n                        this.computedObserver.setErrors({ INN: [this.$t('validator.inn')] });\r\n                        this.contractorSelected(null, true)\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        },\r\n        getSingleContractorByInn () {\r\n            if (this.computedObserver.fields.INN.valid) {\r\n                helperService.validateInnFromApi(this.editingItem.inn)\r\n                    .then(res => {\r\n                        if (res.data) {\r\n                            helperService.getSingleContractorByInn(this.editingItem.inn)\r\n                                .then(res => {\r\n                                    this.contractorNotFound = false\r\n                                    this.contractorSelected(res.data, false, true)\r\n                                })\r\n                                .catch(e => {\r\n                                    this.contractorNotFound = true\r\n                                })\r\n                        } else {\r\n                            this.computedObserver.setErrors({ INN: [this.$t('validator.inn')] });\r\n                            this.contractorSelected(null, true)\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                    })\r\n            }\r\n        },\r\n        handleWidthLengthInput (widthOrLength) {\r\n            if (this.editingItem.width && this.editingItem.length) {\r\n                try {\r\n                    this.editingItem.volume = parseFloat(this.editingItem.width) * parseFloat(this.editingItem.length)\r\n                    this.findAndSetAdVolumeType()\r\n                    this.calculateAndSetMonthlyPayment()\r\n                } catch (error) {\r\n                    this.editingItem.volume = null\r\n                    this.calculateAndSetMonthlyPayment()\r\n                    this.findAndSetAdVolumeType()\r\n                }\r\n            } else {\r\n                this.editingItem.volume = null\r\n                this.calculateAndSetMonthlyPayment()\r\n                this.findAndSetAdVolumeType()\r\n            }\r\n        },\r\n        addPassportDateChanged (e) {\r\n            if (e[0]) {\r\n                this.editingItem.passportGivenDate = e[0]\r\n                this.editingItem.passportExpireDate = e[1]\r\n            } else {\r\n                this.editingItem.passportGivenDate = null\r\n                this.editingItem.passportExpireDate = null\r\n            }\r\n        },\r\n        customLabelAdSide (opt) {\r\n            let selected = this.adSides.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelAdVolumeType (opt) {\r\n            let selected = this.adVolumeTypes.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelAdZone (opt) {\r\n            let selected = this.adZones.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelAdRegionGroup (opt) {\r\n            let selected = this.adGroups.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelAdType (opt) {\r\n            let selected = this.adTypes.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelStreet (opt) {\r\n            let selected = this.streets.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelQuarter (opt) {\r\n            let selected = this.quarters.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelDistrict (opt) {\r\n            let selected = this.districts.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        async regionSelected ($event, dontResetDistrict = false) {\r\n            if (!dontResetDistrict) {\r\n                this.editingItem.addressDto.districtId = null\r\n            }\r\n            if ($event) {\r\n                // GET DISTRICTS\r\n                await helperService.getGeoLocationsByParentId($event)\r\n                    .then(res => {\r\n                        this.districts = res.data\r\n                        if (dontResetDistrict)\r\n                            this.districtSelected(this.editingItem.addressDto.districtId, true)\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                    })\r\n            }\r\n        },\r\n        getCoefficientValue (districtId, adZoneId) {\r\n            if (districtId && adZoneId && this.isByAgency) {\r\n                helperService.getCoefficientValueByZoneAndDistrictIds(districtId, adZoneId)\r\n                    .then(res => {\r\n                        this.coefficientValue = res.data ? res.data.coefficient : null\r\n                        if (this.minCollectionValue) {\r\n                            this.calculateAndSetMonthlyPayment()\r\n                            // this.$set(this.editingItem, 'monthlyPayment', parseFloat(this.minCollectionValue) * parseFloat(this.coefficientValue))\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                        this.coefficientValue = null\r\n                        // this.$set(this.editingItem, 'monthlyPayment', null)\r\n                        this.calculateAndSetMonthlyPayment()\r\n                    })\r\n            }\r\n        },\r\n        getMinCollectionValue (regionId, districtId, adLocationTypeId, adDesignTypeId, adVolumeTypeId) {\r\n            // GET MINIMUM_COLLECTION (M) BY REGION, DISTRICT AND AD_DESIGN_TYPE IDS\r\n            if (regionId && districtId && adLocationTypeId && adDesignTypeId && this.isByAgency && !this.editingItem.isUzAvtoYul) {\r\n                helperService.getMinCollectionValueByRegionAndDistrictIds(regionId, districtId, adLocationTypeId, adDesignTypeId, adVolumeTypeId)\r\n                    .then(res => {\r\n                        this.minCollectionValue = res.data ? res.data.cost : null\r\n                        if (this.coefficientValue) {\r\n                            this.calculateAndSetMonthlyPayment()\r\n                            // this.$set(this.editingItem, 'monthlyPayment', parseFloat(this.minCollectionValue) * parseFloat(this.coefficientValue))\r\n                        }\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                        this.minCollectionValue = null\r\n                        this.calculateAndSetMonthlyPayment()\r\n                        // this.$set(this.editingItem, 'monthlyPayment', null)\r\n                    })\r\n            } else {\r\n                this.minCollectionValue = null\r\n            }\r\n        },\r\n        async districtSelected ($event, dontResetQuarter = false) {\r\n            if (!dontResetQuarter) {\r\n                this.editingItem.addressDto.quarterId = null\r\n                this.editingItem.directoryAdvertisementZoneId = null\r\n            }\r\n            if ($event) {\r\n                // GET QUARTERS\r\n                await crudAndListsService.searchListWithKeyword('directory/quarter-names', this.var_default_search_payload, `get-by-districtId/${$event}`)\r\n                    .then(res => {\r\n                        this.quarters = res.data.list\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                        this.quarters = []\r\n                    })\r\n            } else {\r\n                this.quarters = []\r\n            }\r\n        },\r\n        async adDesignTypeSelected ($event) {\r\n            this.getMinCollectionValue(this.editingItem.addressDto.regionId, this.editingItem.addressDto.districtId, this.editingItem.directoryAdvertisementLocationTypeId, $event, this.editingItem.directoryAdvertisementVolumeTypeId)\r\n            this.getPrivilegeCoefficientValueByAdDesignTypeId($event)\r\n        },\r\n        async adZoneSelected ($event) {\r\n            this.getCoefficientValue(this.editingItem.addressDto.districtId, $event)\r\n        },\r\n        customObjectState (opt) {\r\n            let selected = this.adObjectStates.find(e => e.id == (opt.id ? opt.id : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelContractor (opt) {\r\n            let selected = this.contractors.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.fullName}`\r\n            }\r\n            return ``;\r\n        },\r\n        contractorReachedEndOfList (e) {\r\n            if (e) {\r\n                this.fetchContractors()\r\n            }\r\n        },\r\n        contractorSelected (contractorDtoOrId, dontResetInn = false, fromInnSearch = false) {\r\n            let foundContractor = fromInnSearch ? this.contractors.find(c => c.id == contractorDtoOrId.id) : this.contractors.find(c => c.id == contractorDtoOrId)\r\n            if (fromInnSearch && contractorDtoOrId && !foundContractor) {\r\n                this.contractors.push(contractorDtoOrId)\r\n                foundContractor = contractorDtoOrId\r\n            }\r\n            if (foundContractor) {\r\n                this.editingItem.contractorId = fromInnSearch ? contractorDtoOrId.id : contractorDtoOrId\r\n                this.editingItem.inn = foundContractor.inn\r\n                this.editingItem.contractorPhoneNumber = null\r\n                this.editingItem.contractorPhoneNumber = foundContractor.mobileNumber\r\n                this.$set(this.editingItem, 'contractorAddress', `${foundContractor.addressDto.regionNameUz}, ${foundContractor.addressDto.districtNameUz} ${foundContractor.addressDto.additional ? ',' + foundContractor.addressDto.additional : ''}`)\r\n                // this.editingItem.contractorAddress = `${foundContractor.addressDto.regionNameUz}, ${foundContractor.addressDto.districtNameUz} ${foundContractor.addressDto.additional ? ',' + foundContractor.addressDto.additional : ''}`\r\n                this.contractorNotFound = false\r\n            } else {\r\n                if (!dontResetInn) {\r\n                    this.editingItem.inn = null\r\n                }\r\n                this.editingItem.contractorId = null\r\n                this.editingItem.contractorPhoneNumber = null\r\n                this.editingItem.contractorAddress = null\r\n            }\r\n        },\r\n        async debounceSearchContractors (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchContractorsWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        /* async debounceSearchContractorsByInn (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.getSingleContractorByInn();\r\n            }, 1000);\r\n        }, */\r\n        fetchContractorsWithKeyword (keyword, makeSelectedByInn = false, fromContractorModalCancel = false) {\r\n            this.contractors = []\r\n            this.contractorSearchPayload.page = 1\r\n            this.contractorSearchPayload.keyword = keyword ? keyword : ''\r\n            this.fetchContractors(makeSelectedByInn, fromContractorModalCancel)\r\n        },\r\n        async fetchContractors (makeSelectedByInn, fromContractorModalCancel) {\r\n            this.isLoadingContractors = true\r\n            await crudAndListsService.searchListWithKeyword('contractor', this.contractorSearchPayload, 'by-contractor')\r\n                .then(res => {\r\n                    this.contractors.push(...res.data.list)\r\n                    if (makeSelectedByInn || fromContractorModalCancel) {\r\n                        let foundContractor = this.contractors.find(el => el.inn == this.editingItem.inn)\r\n                        if (foundContractor) {\r\n                            this.contractorSelected(foundContractor.id)\r\n                        }\r\n                    }\r\n                    this.hasNextPageContractors = res.data.total / this.contractorSearchPayload.itemsPerPage > this.contractorSearchPayload.page\r\n                    this.contractorSearchPayload.page += 1\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.contractors = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingContractors = false\r\n                })\r\n        },\r\n        async adLocationTypeSelected (adLocationTypeObjectOrId, dontResetAdDesignType = false) {\r\n            if (!dontResetAdDesignType) {\r\n                this.editingItem.directoryAdvertisementDesignTypeId = null\r\n                this.editingItem.directoryAdvertisementVolumeTypeId = null\r\n            }\r\n            if (adLocationTypeObjectOrId) {\r\n                this.getMinCollectionValue(this.editingItem.addressDto.regionId, this.editingItem.addressDto.districtId, adLocationTypeObjectOrId.id ? adLocationTypeObjectOrId.id : adLocationTypeObjectOrId, this.editingItem.directoryAdvertisementDesignTypeId, this.editingItem.directoryAdvertisementVolumeTypeId)\r\n                // GET AD_VOLUME_TYPES\r\n                helperService\r\n                    .getAdVolumeTypesByAdLocationTypeId(adLocationTypeObjectOrId.id ? adLocationTypeObjectOrId.id : adLocationTypeObjectOrId)\r\n                    .then((res) => {\r\n                        this.adVolumeTypes = res.data\r\n                        this.findAndSetAdVolumeType()\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                    })\r\n                if (this.editingItem.addressDto.regionId) {\r\n                    // GET AD_DESIGN_TYPES\r\n                    helperService\r\n                        .getAdDesignTypesByAdLocationTypeId(adLocationTypeObjectOrId.id ? adLocationTypeObjectOrId.id : adLocationTypeObjectOrId, this.editingItem.addressDto.regionId)\r\n                        .then((res) => {\r\n                            this.adDesignTypes = res.data\r\n                        })\r\n                        .catch(e => {\r\n                            console.log(e)\r\n                            this.adDesignTypes = []\r\n                        })\r\n                } else {\r\n                    this.adDesignTypes = []\r\n                }\r\n            } else {\r\n                this.adDesignTypes = []\r\n                this.adVolumeTypes = []\r\n            }\r\n        },\r\n        customLabelAdLocationType (opt) {\r\n            let selected = this.adLocationTypes.find(e => e.id == (opt.id ? opt.id : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelAdDesignType (opt) {\r\n            let selected = this.adDesignTypes.find(e => e.id == (opt.id ? opt.id : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelRegion (opt) {\r\n            let selected = this.regions.find(e => e.regionId == (opt.regionId ? opt.regionId : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.regionNameRu,\r\n                    nameLt: selected.regionNameLt,\r\n                    nameUz: selected.regionNameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelUnit (opt) {\r\n            let selected = this.units.find(e => e.id == (opt.id ? opt.id : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        treeClosed (veeName) {\r\n            this.computedObserver.refs[veeName].validate();\r\n        },\r\n        normalizer (node) {\r\n            if (!node.children || node.children.length === 0) {\r\n                delete node.children\r\n                return {\r\n                    id: node.id,\r\n                    label: this.getName({\r\n                        nameRu: node.nameRu,\r\n                        nameLt: node.nameLt,\r\n                        nameUz: node.nameUz,\r\n                    }),\r\n                }\r\n            }\r\n            return {\r\n                id: node.id,\r\n                label: this.getName({\r\n                    nameRu: node.nameRu,\r\n                    nameLt: node.nameLt,\r\n                    nameUz: node.nameUz,\r\n                }),\r\n                children: node.children && node.children.length > 0 ? node.children : [],\r\n            }\r\n        },\r\n        save () {\r\n            this.computedObserver.validate().then(valid => {\r\n                if (valid) {\r\n                    if (this.editingItem.id || this.$route.params.id) {\r\n                        crudAndListsService.update(MAIN_API_URL, this.editingItem, false, true).then(res => {\r\n                            this.computedObserver.reset()\r\n                            this.editingItem = Object.assign({}, { addressDto: {} });\r\n                            this.$router.go(-1)\r\n                            this.$toast(this.$t('messages.saved_successfully'), { type: 'success' });\r\n                        })\r\n                    } else {\r\n                        crudAndListsService.create(MAIN_API_URL, this.editingItem, false, true).then(res => {\r\n                            this.computedObserver.reset()\r\n                            this.editingItem = Object.assign({}, { addressDto: {} });\r\n                            this.$router.go(-1)\r\n                            this.$toast(this.$t('messages.saved_successfully'), { type: 'success' });\r\n                        })\r\n                    }\r\n                } else {\r\n                    this.$toast(this.$t('messages.fill_required_fields'), { type: 'error' });\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * CREATED */\r\n    async created () {\r\n        this.var_default_search_payload.itemsPerPage = 500;\r\n        this.contractorSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        if (this.isModeCreate) {\r\n            await crudAndListsService.getEmpty(MAIN_API_URL)\r\n                .then(res => {\r\n                    this.editingItem = res.data\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        } else {\r\n            await crudAndListsService.getById(MAIN_API_URL, this.$route.params.id, true, null)\r\n                .then(res => {\r\n                    this.editingItem = res.data\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        }\r\n\r\n        // GET REGIONS\r\n        await helperService.fetchRegionsForPetrolByCurrentUserId()\r\n            .then(res => {\r\n                this.regions = res.data\r\n                this.regionSelected(this.editingItem.addressDto ? this.editingItem.addressDto.regionId : null, true)\r\n            })\r\n            .catch(e => {\r\n                console.log(e)\r\n            })\r\n\r\n        // GET CONTRACTORS\r\n        await this.fetchContractors()\r\n        if (!this.isModeCreate) {\r\n            this.contractorSelected(this.editingItem.contractorId)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.col-form-label {\r\n    padding-top: 0;\r\n}\r\n\r\nul {\r\n    list-style-type: none;\r\n}\r\n\r\n.dz-remove {\r\n    display: inline-block !important;\r\n    width: 1.2em;\r\n    height: 1.2em;\r\n\r\n    position: absolute;\r\n    top: 5px;\r\n    right: 5px;\r\n    z-index: 1000;\r\n\r\n    font-size: 1.2em !important;\r\n    line-height: 1em;\r\n\r\n    text-align: center;\r\n    font-weight: bold;\r\n    border: 1px solid gray !important;\r\n    border-radius: 1.2em;\r\n    color: gray;\r\n    background-color: white;\r\n    opacity: 0.5;\r\n}\r\n\r\n.dz-remove:hover {\r\n    text-decoration: none !important;\r\n    opacity: 1;\r\n}\r\n</style>"]}]}